"""
This type stub file was generated by pyright.
"""

import mlx.core as mx
import mlx.nn as nn
from dataclasses import dataclass
from pathlib import Path
from typing import Union

def get_prompt(model_type, processor, conversation):
    ...

class Dataset:
    def __init__(self, hf_dataset, config, processor, image_processor=..., take=..., split=..., image_resize_shape=...) -> None:
        ...
    
    def __len__(self): # -> int:
        ...
    
    def __getitem__(self, idx): # -> dict[str | Any, Any]:
        ...
    


def grad_checkpoint(layer): # -> None:
    """
    Update all instances of type(layer) to use gradient checkpointing.
    """
    ...

@dataclass
class TrainingArgs:
    batch_size: int = ...
    iters: int = ...
    val_batches: int = ...
    steps_per_report: int = ...
    steps_per_eval: int = ...
    steps_per_save: int = ...
    max_seq_length: int = ...
    adapter_file: str = ...
    grad_checkpoint: bool = ...


def default_loss(model, inputs, targets, lengths): # -> tuple[Any, Any]:
    ...

class Trainer:
    def __init__(self, model, optimizer, train_on_completions=..., assistant_id=..., clip_gradients=...) -> None:
        ...
    
    def loss_fn(self, model, batch):
        ...
    
    def train_step(self, batch):
        ...
    
    @mx.compile
    def train_epoch(self, dataloader): # -> float:
        ...
    


def save_adapter(model: nn.Module, adapter_file: Union[str, Path]): # -> None:
    ...

