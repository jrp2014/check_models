2025-11-20 17:17:13,118 - DEBUG - Verbose/debug mode enabled.
2025-11-20 17:17:13,119 - INFO - --- Library Versions ---
2025-11-20 17:17:13,119 - INFO - Pillow          : 12.0.0
2025-11-20 17:17:13,119 - INFO - huggingface-hub : 0.36.0
2025-11-20 17:17:13,119 - INFO - mlx             : 0.30.0
2025-11-20 17:17:13,119 - INFO - mlx-lm          : 0.28.4
2025-11-20 17:17:13,119 - INFO - mlx-vlm         : 0.3.7
2025-11-20 17:17:13,119 - INFO - tokenizers      : 0.22.1
2025-11-20 17:17:13,119 - INFO - transformers    : 4.57.1
2025-11-20 17:17:13,119 - INFO - Generated: 2025-11-20 17:17:13 GMT
2025-11-20 17:17:13,373 - INFO - 
2025-11-20 17:17:13,373 - INFO - --- System Information ---
2025-11-20 17:17:13,373 - INFO - OS                  : Darwin 25.1.0
2025-11-20 17:17:13,373 - INFO - macOS Version       : 26.1
2025-11-20 17:17:13,373 - INFO - SDK Version         : 26.1
2025-11-20 17:17:13,373 - INFO - Python Version      : 3.13.9
2025-11-20 17:17:13,373 - INFO - Architecture        : arm64
2025-11-20 17:17:13,373 - INFO - GPU/Chip            : Apple M4 Max
2025-11-20 17:17:13,373 - INFO - GPU Cores           : 40
2025-11-20 17:17:13,373 - INFO - Metal Support       : Metal 4
2025-11-20 17:17:13,373 - INFO - RAM                 : 128.0 GB
2025-11-20 17:17:13,373 - INFO - CPU Cores (Physical): 16
2025-11-20 17:17:13,373 - INFO - CPU Cores (Logical) : 16
2025-11-20 17:17:13,373 - DEBUG - 
2025-11-20 17:17:13,373 - DEBUG - ================================================================================
2025-11-20 17:17:13,373 - DEBUG - FULL ENVIRONMENT DUMP (for reproducibility)
2025-11-20 17:17:13,373 - DEBUG - ================================================================================
2025-11-20 17:17:13,373 - DEBUG - 
2025-11-20 17:17:13,549 - DEBUG - --- pip freeze ---
2025-11-20 17:17:13,550 - DEBUG - aiohappyeyeballs==2.6.1
2025-11-20 17:17:13,550 - DEBUG - aiohttp==3.13.2
2025-11-20 17:17:13,550 - DEBUG - aiosignal==1.4.0
2025-11-20 17:17:13,550 - DEBUG - annotated-doc==0.0.4
2025-11-20 17:17:13,550 - DEBUG - annotated-types==0.7.0
2025-11-20 17:17:13,550 - DEBUG - anyio==4.11.0
2025-11-20 17:17:13,550 - DEBUG - attrs==25.4.0
2025-11-20 17:17:13,550 - DEBUG - certifi==2025.11.12
2025-11-20 17:17:13,550 - DEBUG - cffi==2.0.0
2025-11-20 17:17:13,550 - DEBUG - charset-normalizer==3.4.4
2025-11-20 17:17:13,550 - DEBUG - click==8.3.1
2025-11-20 17:17:13,550 - DEBUG - cmake==4.1.3
2025-11-20 17:17:13,550 - DEBUG - coverage==7.12.0
2025-11-20 17:17:13,550 - DEBUG - cryptography==46.0.3
2025-11-20 17:17:13,550 - DEBUG - datasets==4.4.1
2025-11-20 17:17:13,550 - DEBUG - dill==0.4.0
2025-11-20 17:17:13,550 - DEBUG - docopt==0.6.2
2025-11-20 17:17:13,550 - DEBUG - einops==0.8.1
2025-11-20 17:17:13,550 - DEBUG - fastapi==0.121.3
2025-11-20 17:17:13,550 - DEBUG - filelock==3.20.0
2025-11-20 17:17:13,550 - DEBUG - frozenlist==1.8.0
2025-11-20 17:17:13,550 - DEBUG - fsspec==2025.10.0
2025-11-20 17:17:13,550 - DEBUG - h11==0.16.0
2025-11-20 17:17:13,550 - DEBUG - hf-xet==1.2.0
2025-11-20 17:17:13,550 - DEBUG - httpcore==1.0.9
2025-11-20 17:17:13,550 - DEBUG - httpx==0.28.1
2025-11-20 17:17:13,550 - DEBUG - httpx-sse==0.4.3
2025-11-20 17:17:13,550 - DEBUG - huggingface-hub==0.36.0
2025-11-20 17:17:13,550 - DEBUG - idna==3.11
2025-11-20 17:17:13,550 - DEBUG - iniconfig==2.3.0
2025-11-20 17:17:13,550 - DEBUG - inquirerpy==0.3.4
2025-11-20 17:17:13,550 - DEBUG - Jinja2==3.1.6
2025-11-20 17:17:13,550 - DEBUG - jsonschema==4.25.1
2025-11-20 17:17:13,550 - DEBUG - jsonschema-specifications==2025.9.1
2025-11-20 17:17:13,550 - DEBUG - markdown-it-py==4.0.0
2025-11-20 17:17:13,550 - DEBUG - MarkupSafe==3.0.3
2025-11-20 17:17:13,550 - DEBUG - mcp==1.21.2
2025-11-20 17:17:13,550 - DEBUG - mdurl==0.1.2
2025-11-20 17:17:13,550 - DEBUG - mlx==0.30.0
2025-11-20 17:17:13,550 - DEBUG - -e git+https://github.com/ml-explore/mlx-lm.git@1d01257d2e21f9cbe31e2df6d64866abbfc33160#egg=mlx_lm
2025-11-20 17:17:13,550 - DEBUG - mlx-metal==0.30.0
2025-11-20 17:17:13,550 - DEBUG - -e git+https://github.com/Blaizzy/mlx-vlm.git@8862ce0e6387d1a68a0e1ce47ad689c9431126d4#egg=mlx_vlm
2025-11-20 17:17:13,550 - DEBUG - -e git+https://github.com/jrp2014/scripts.git@5d5adeb35a5293831f1a1ecd22d73d73d9634719#egg=mlx_vlm_check&subdirectory=src
2025-11-20 17:17:13,550 - DEBUG - mpmath==1.3.0
2025-11-20 17:17:13,550 - DEBUG - multidict==6.7.0
2025-11-20 17:17:13,550 - DEBUG - multiprocess==0.70.18
2025-11-20 17:17:13,550 - DEBUG - mypy==1.18.2
2025-11-20 17:17:13,550 - DEBUG - mypy_extensions==1.1.0
2025-11-20 17:17:13,550 - DEBUG - nanobind==2.4.0
2025-11-20 17:17:13,550 - DEBUG - networkx==3.5
2025-11-20 17:17:13,550 - DEBUG - ninja==1.13.0
2025-11-20 17:17:13,550 - DEBUG - num2words==0.5.14
2025-11-20 17:17:13,550 - DEBUG - numpy==2.2.6
2025-11-20 17:17:13,550 - DEBUG - opencv-python==4.12.0.88
2025-11-20 17:17:13,550 - DEBUG - packaging==25.0
2025-11-20 17:17:13,550 - DEBUG - pandas==2.3.3
2025-11-20 17:17:13,550 - DEBUG - pathspec==0.12.1
2025-11-20 17:17:13,550 - DEBUG - pfzy==0.3.4
2025-11-20 17:17:13,550 - DEBUG - pillow==12.0.0
2025-11-20 17:17:13,550 - DEBUG - pluggy==1.6.0
2025-11-20 17:17:13,550 - DEBUG - prompt_toolkit==3.0.52
2025-11-20 17:17:13,551 - DEBUG - propcache==0.4.1
2025-11-20 17:17:13,551 - DEBUG - protobuf==6.33.1
2025-11-20 17:17:13,551 - DEBUG - psutil==7.1.3
2025-11-20 17:17:13,551 - DEBUG - pyarrow==22.0.0
2025-11-20 17:17:13,551 - DEBUG - pycparser==2.23
2025-11-20 17:17:13,551 - DEBUG - pydantic==2.12.4
2025-11-20 17:17:13,551 - DEBUG - pydantic-settings==2.12.0
2025-11-20 17:17:13,551 - DEBUG - pydantic_core==2.41.5
2025-11-20 17:17:13,551 - DEBUG - Pygments==2.19.2
2025-11-20 17:17:13,551 - DEBUG - PyJWT==2.10.1
2025-11-20 17:17:13,551 - DEBUG - pytest==9.0.1
2025-11-20 17:17:13,551 - DEBUG - pytest-cov==7.0.0
2025-11-20 17:17:13,551 - DEBUG - python-dateutil==2.9.0.post0
2025-11-20 17:17:13,551 - DEBUG - python-dotenv==1.2.1
2025-11-20 17:17:13,551 - DEBUG - python-multipart==0.0.20
2025-11-20 17:17:13,551 - DEBUG - pytz==2025.2
2025-11-20 17:17:13,551 - DEBUG - PyYAML==6.0.3
2025-11-20 17:17:13,551 - DEBUG - referencing==0.37.0
2025-11-20 17:17:13,551 - DEBUG - regex==2025.11.3
2025-11-20 17:17:13,551 - DEBUG - requests==2.32.5
2025-11-20 17:17:13,551 - DEBUG - rich==14.2.0
2025-11-20 17:17:13,551 - DEBUG - rpds-py==0.29.0
2025-11-20 17:17:13,551 - DEBUG - ruff==0.14.5
2025-11-20 17:17:13,551 - DEBUG - safetensors==0.7.0
2025-11-20 17:17:13,551 - DEBUG - sentencepiece==0.2.1
2025-11-20 17:17:13,551 - DEBUG - setuptools==80.9.0
2025-11-20 17:17:13,551 - DEBUG - shellingham==1.5.4
2025-11-20 17:17:13,551 - DEBUG - six==1.17.0
2025-11-20 17:17:13,551 - DEBUG - sniffio==1.3.1
2025-11-20 17:17:13,551 - DEBUG - soundfile==0.13.1
2025-11-20 17:17:13,551 - DEBUG - sse-starlette==3.0.3
2025-11-20 17:17:13,551 - DEBUG - starlette==0.50.0
2025-11-20 17:17:13,551 - DEBUG - sympy==1.14.0
2025-11-20 17:17:13,551 - DEBUG - tabulate==0.9.0
2025-11-20 17:17:13,551 - DEBUG - tokenizers==0.22.1
2025-11-20 17:17:13,551 - DEBUG - torch==2.9.1
2025-11-20 17:17:13,551 - DEBUG - torchaudio==2.9.1
2025-11-20 17:17:13,551 - DEBUG - torchvision==0.24.1
2025-11-20 17:17:13,551 - DEBUG - tqdm==4.67.1
2025-11-20 17:17:13,551 - DEBUG - transformers==4.57.1
2025-11-20 17:17:13,551 - DEBUG - ty==0.0.1a27
2025-11-20 17:17:13,551 - DEBUG - typer==0.20.0
2025-11-20 17:17:13,551 - DEBUG - types-psutil==7.0.0.20251116
2025-11-20 17:17:13,551 - DEBUG - types-PyYAML==6.0.12.20250915
2025-11-20 17:17:13,551 - DEBUG - types-requests==2.32.4.20250913
2025-11-20 17:17:13,551 - DEBUG - types-simplejson==3.20.0.20250822
2025-11-20 17:17:13,551 - DEBUG - types-tabulate==0.9.0.20241207
2025-11-20 17:17:13,551 - DEBUG - types-toml==0.10.8.20240310
2025-11-20 17:17:13,551 - DEBUG - types-tqdm==4.67.0.20250809
2025-11-20 17:17:13,551 - DEBUG - types-urllib3==1.26.25.14
2025-11-20 17:17:13,551 - DEBUG - typing-inspection==0.4.2
2025-11-20 17:17:13,551 - DEBUG - typing_extensions==4.15.0
2025-11-20 17:17:13,551 - DEBUG - tzdata==2025.2
2025-11-20 17:17:13,551 - DEBUG - tzlocal==5.3.1
2025-11-20 17:17:13,551 - DEBUG - urllib3==2.5.0
2025-11-20 17:17:13,551 - DEBUG - uvicorn==0.38.0
2025-11-20 17:17:13,551 - DEBUG - wcwidth==0.2.14
2025-11-20 17:17:13,551 - DEBUG - wheel==0.45.1
2025-11-20 17:17:13,551 - DEBUG - xxhash==3.6.0
2025-11-20 17:17:13,551 - DEBUG - yarl==1.22.0
2025-11-20 17:17:13,551 - DEBUG - 
2025-11-20 17:17:14,425 - DEBUG - --- conda list (env: mlx-vlm) ---
2025-11-20 17:17:14,425 - DEBUG - # packages in environment at /opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm:
2025-11-20 17:17:14,425 - DEBUG - #
2025-11-20 17:17:14,425 - DEBUG - # Name                       Version          Build               Channel
2025-11-20 17:17:14,425 - DEBUG - aiohappyeyeballs             2.6.1            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - aiohttp                      3.13.2           pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - aiosignal                    1.4.0            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - annotated-doc                0.0.4            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - annotated-types              0.7.0            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - anyio                        4.11.0           pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - attrs                        25.4.0           pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - bzip2                        1.0.8            h80987f9_6
2025-11-20 17:17:14,425 - DEBUG - ca-certificates              2025.11.4        hca03da5_0
2025-11-20 17:17:14,425 - DEBUG - certifi                      2025.11.12       pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - cffi                         2.0.0            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - charset-normalizer           3.4.4            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - click                        8.3.1            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - cmake                        4.1.3            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - coverage                     7.12.0           pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - cryptography                 46.0.3           pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - datasets                     4.4.1            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - dill                         0.4.0            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - docopt                       0.6.2            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - einops                       0.8.1            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - expat                        2.7.3            h982b769_0
2025-11-20 17:17:14,425 - DEBUG - fastapi                      0.121.3          pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - filelock                     3.20.0           pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - frozenlist                   1.8.0            pypi_0              pypi
2025-11-20 17:17:14,425 - DEBUG - fsspec                       2025.10.0        pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - h11                          0.16.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - hf-xet                       1.2.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - httpcore                     1.0.9            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - httpx                        0.28.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - httpx-sse                    0.4.3            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - huggingface-hub              0.36.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - idna                         3.11             pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - iniconfig                    2.3.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - inquirerpy                   0.3.4            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - jinja2                       3.1.6            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - jsonschema                   4.25.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - jsonschema-specifications    2025.9.1         pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - libcxx                       20.1.8           hd7fd590_1
2025-11-20 17:17:14,426 - DEBUG - libffi                       3.4.4            hca03da5_1
2025-11-20 17:17:14,426 - DEBUG - libmpdec                     4.0.0            h80987f9_0
2025-11-20 17:17:14,426 - DEBUG - libzlib                      1.3.1            h5f15de7_0
2025-11-20 17:17:14,426 - DEBUG - markdown-it-py               4.0.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - markupsafe                   3.0.3            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mcp                          1.21.2           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mdurl                        0.1.2            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mlx                          0.30.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mlx-lm                       0.28.4           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mlx-metal                    0.30.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mlx-vlm                      0.3.7            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mlx-vlm-check                0.1.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mpmath                       1.3.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - multidict                    6.7.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - multiprocess                 0.70.18          pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mypy                         1.18.2           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - mypy-extensions              1.1.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - nanobind                     2.4.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - ncurses                      6.5              hee39554_0
2025-11-20 17:17:14,426 - DEBUG - networkx                     3.5              pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - ninja                        1.13.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - num2words                    0.5.14           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - numpy                        2.2.6            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - opencv-python                4.12.0.88        pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - openssl                      3.0.18           h9b4081a_0
2025-11-20 17:17:14,426 - DEBUG - packaging                    25.0             pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pandas                       2.3.3            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pathspec                     0.12.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pfzy                         0.3.4            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pillow                       12.0.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pip                          25.3             pyhc872135_0
2025-11-20 17:17:14,426 - DEBUG - pluggy                       1.6.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - prompt-toolkit               3.0.52           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - propcache                    0.4.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - protobuf                     6.33.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - psutil                       7.1.3            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pyarrow                      22.0.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pycparser                    2.23             pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pydantic                     2.12.4           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pydantic-core                2.41.5           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pydantic-settings            2.12.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pygments                     2.19.2           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pyjwt                        2.10.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pytest                       9.0.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pytest-cov                   7.0.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - python                       3.13.9           hc7d8306_100_cp313
2025-11-20 17:17:14,426 - DEBUG - python-dateutil              2.9.0.post0      pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - python-dotenv                1.2.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - python-multipart             0.0.20           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - python_abi                   3.13             1_cp313
2025-11-20 17:17:14,426 - DEBUG - pytz                         2025.2           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - pyyaml                       6.0.3            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - readline                     8.3              h0b18652_0
2025-11-20 17:17:14,426 - DEBUG - referencing                  0.37.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - regex                        2025.11.3        pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - requests                     2.32.5           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - rich                         14.2.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - rpds-py                      0.29.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - ruff                         0.14.5           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - safetensors                  0.7.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - sentencepiece                0.2.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - setuptools                   80.9.0           py313hca03da5_0
2025-11-20 17:17:14,426 - DEBUG - shellingham                  1.5.4            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - six                          1.17.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - sniffio                      1.3.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - soundfile                    0.13.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - sqlite                       3.51.0           hab6afd1_0
2025-11-20 17:17:14,426 - DEBUG - sse-starlette                3.0.3            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - starlette                    0.50.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - sympy                        1.14.0           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - tabulate                     0.9.0            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - tk                           8.6.15           hcd8a7d5_0
2025-11-20 17:17:14,426 - DEBUG - tokenizers                   0.22.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - torch                        2.9.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - torchaudio                   2.9.1            pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - torchvision                  0.24.1           pypi_0              pypi
2025-11-20 17:17:14,426 - DEBUG - tqdm                         4.67.1           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - transformers                 4.57.1           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - ty                           0.0.1a27         pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - typer                        0.20.0           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-psutil                 7.0.0.20251116   pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-pyyaml                 6.0.12.20250915  pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-requests               2.32.4.20250913  pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-simplejson             3.20.0.20250822  pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-tabulate               0.9.0.20241207   pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-toml                   0.10.8.20240310  pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-tqdm                   4.67.0.20250809  pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - types-urllib3                1.26.25.14       pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - typing-extensions            4.15.0           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - typing-inspection            0.4.2            pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - tzdata                       2025.2           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - tzlocal                      5.3.1            pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - urllib3                      2.5.0            pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - uvicorn                      0.38.0           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - wcwidth                      0.2.14           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - wheel                        0.45.1           py313hca03da5_0
2025-11-20 17:17:14,427 - DEBUG - xxhash                       3.6.0            pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - xz                           5.6.4            h80987f9_1
2025-11-20 17:17:14,427 - DEBUG - yarl                         1.22.0           pypi_0              pypi
2025-11-20 17:17:14,427 - DEBUG - zlib                         1.3.1            h5f15de7_0
2025-11-20 17:17:14,427 - DEBUG - 
2025-11-20 17:17:14,427 - DEBUG - ================================================================================
2025-11-20 17:17:14,427 - DEBUG - Environment dump completed at 2025-11-20 17:17:14 GMT
2025-11-20 17:17:14,427 - DEBUG - ================================================================================
2025-11-20 17:17:14,427 - DEBUG - 
2025-11-20 17:17:14,427 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,427 - WARNING - SECURITY WARNING: --trust-remote-code is enabled.
2025-11-20 17:17:14,427 - WARNING - This allows execution of remote code and may pose security risks.
2025-11-20 17:17:14,427 - INFO - ================================================================================
2025-11-20 17:17:14,427 - INFO - MLX Vision Language Model Check
2025-11-20 17:17:14,427 - INFO - ================================================================================
2025-11-20 17:17:14,427 - INFO - Scanning folder: [95m/Users/jrp/Pictures/Processed[0m
2025-11-20 17:17:14,427 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,457 - DEBUG - Most recent image file found: /Users/jrp/Pictures/Processed/20251115-161928_DSC07372.jpg
2025-11-20 17:17:14,457 - INFO - Image File: [95m/Users/jrp/Pictures/Processed/20251115-161928_DSC07372.jpg[0m
2025-11-20 17:17:14,457 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,462 - INFO - Image dimensions: 8640x5400 (46.7 MPixels)
2025-11-20 17:17:14,462 - INFO - Image Metadata
2025-11-20 17:17:14,462 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,463 - INFO - Date: 2025-11-15 16:19:28 GMT
2025-11-20 17:17:14,464 - INFO - Description: , White Rock, Hastings, England, United Kingdom, UK
Here is a caption for the image, written for the specified audience and context:

A damp, late autumn afternoon along the seafront at White Rock in Hastings, England. The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool, overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a streak of colour and a sense of movement to the otherwise quiet, atmospheric scene. This area was developed significantly during the Victorian era as Hastings grew into a popular coastal resort, and this image captures a modern, tranquil moment outside the peak tourist season.
2025-11-20 17:17:14,464 - INFO - GPS Location: 
2025-11-20 17:17:14,464 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,465 - INFO - ================================================================================
2025-11-20 17:17:14,465 - INFO -                              EXIF Metadata Summary                              
2025-11-20 17:17:14,465 - INFO - ================================================================================
2025-11-20 17:17:14,465 - INFO - ╒══════════════════════════╤══════════════════════════════════════════════════════════════╕
2025-11-20 17:17:14,465 - INFO - │ [1m[94mTag[0m                      │ [1m[94mValue[0m                                                        │
2025-11-20 17:17:14,465 - INFO - ╞══════════════════════════╪══════════════════════════════════════════════════════════════╡
2025-11-20 17:17:14,465 - INFO - │ ResolutionUnit           │ 2                                                            │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ [1m[93mImageDescription[0m         │ , White Rock, Hastings, England, United Kingdom, UK Here ... │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ [1m[93mMake[0m                     │ SONY                                                         │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ [1m[93mModel[0m                    │ ILCE-1M2                                                     │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ Software                 │ Adobe Photoshop Lightroom Classic 15.0.1 (Macintosh)         │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ Orientation              │ 1                                                            │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ DateTime                 │ 2025:11:16 00:51:12                                          │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ YResolution              │ 240.0                                                        │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ Copyright                │ Copyright Â© 2025 John Pavel                                 │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ XResolution              │ 240.0                                                        │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ Artist                   │ John Pavel                                                   │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ ExifVersion              │ 0232                                                         │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ ShutterSpeedValue        │ 4.906891                                                     │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ ApertureValue            │ 3.61471                                                      │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ [1m[93mDateTimeOriginal[0m         │ 2025:11:15 16:19:28                                          │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ DateTimeDigitized        │ 2025:11:15 16:19:28                                          │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ BrightnessValue          │ 2.38046875                                                   │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ ExposureBiasValue        │ -0.7                                                         │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ MaxApertureValue         │ 2.0                                                          │
2025-11-20 17:17:14,465 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,465 - INFO - │ MeteringMode             │ 5                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ LightSource              │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ Flash                    │ 16                                                           │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ [1m[93mFocalLength[0m              │ 30.0                                                         │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ ColorSpace               │ 1                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ DigitalZoomRatio         │ 1.0                                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ FocalPlaneXResolution    │ 2404.622283935547                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ FocalPlaneYResolution    │ 2404.622283935547                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ FocalPlaneResolutionUnit │ 3                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ SubsecTimeOriginal       │ 201                                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ SubsecTimeDigitized      │ 201                                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ Sharpness                │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ FileSource               │                                                              │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ [1m[93mExposureTime[0m             │ 0.03333333333333333                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ [1m[93mFNumber[0m                  │ 3.5                                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ SceneType                │                                                              │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ [1m[93mExposureProgram[0m          │ 3                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ CustomRendered           │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ [1m[93mISOSpeedRatings[0m          │ 250                                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ ExposureMode             │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ SensitivityType          │ 2                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ WhiteBalance             │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ RecommendedExposureIndex │ 250                                                          │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ BodySerialNumber         │ 02050506                                                     │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ LensSpecification        │ (28.0, 70.0, 2.0, 2.0)                                       │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ [1m[93mLensModel[0m                │ FE 28-70mm F2 GM                                             │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ FocalLengthIn35mmFilm    │ 30                                                           │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ SceneCaptureType         │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ Contrast                 │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ├──────────────────────────┼──────────────────────────────────────────────────────────────┤
2025-11-20 17:17:14,466 - INFO - │ Saturation               │ 0                                                            │
2025-11-20 17:17:14,466 - INFO - ╘══════════════════════════╧══════════════════════════════════════════════════════════════╛
2025-11-20 17:17:14,466 - INFO - ================================================================================
2025-11-20 17:17:14,466 - INFO - Prompt Configuration
2025-11-20 17:17:14,466 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,466 - INFO - Generating default prompt based on image metadata.
2025-11-20 17:17:14,466 - DEBUG - Using generated prompt based on metadata.
2025-11-20 17:17:14,466 - INFO - Final prompt: Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image. 

Context: The image relates to ', White Rock, Hastings, England, United Kingdom, UK
Here is...
2025-11-20 17:17:14,466 - INFO - Scanning cache for models to process...
2025-11-20 17:17:14,483 - INFO - Processing 32 model(s)...
2025-11-20 17:17:14,483 - INFO - 
2025-11-20 17:17:14,483 - INFO - Metrics Format:
2025-11-20 17:17:14,483 - INFO -   • Compact mode: tokens(total/prompt/gen) format with aligned keys
2025-11-20 17:17:14,483 - INFO -   • ⚠️  warnings shown for repetitive or hallucinated output
2025-11-20 17:17:14,483 - INFO -   • Note: Streaming early-stop for repetitive output is not yet implemented
2025-11-20 17:17:14,483 - INFO - 
2025-11-20 17:17:14,483 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,483 - INFO - Processing Model [1/32]: [95mHuggingFaceTB/SmolVLM-Instruct[0m
2025-11-20 17:17:14,483 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:14,483 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mHuggingFaceTB/SmolVLM-Instruct[0m
2025-11-20 17:17:14,633 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:17:16,790 - DEBUG - Cleaned up resources for model HuggingFaceTB/SmolVLM-Instruct
2025-11-20 17:17:16,791 - INFO - Quality analysis for HuggingFaceTB/SmolVLM-Instruct: no issues detected
2025-11-20 17:17:16,791 - INFO - [92m[RUN 1/32] SUMMARY model=HuggingFaceTB/SmolVLM-Instruct status=OK tokens=1439[0m
2025-11-20 17:17:16,791 - INFO - [92mprompt=1430 gen=9 gen_tps=131 peak_mem=5.5GB total_time=2.30s[0m
2025-11-20 17:17:16,791 - INFO - [1m[92m✓ SUCCESS: [95mHuggingFaceTB/SmolVLM-Instruct[0m[0m
2025-11-20 17:17:16,791 - INFO - 
2025-11-20 17:17:16,791 - INFO - Generated Text:
2025-11-20 17:17:16,791 - INFO -    A rainy day in Hastings, England.
2025-11-20 17:17:16,791 - INFO - 
2025-11-20 17:17:16,791 - INFO - 
2025-11-20 17:17:16,791 - INFO - 📊 Metrics: total=2.30s  gen=1.68s  load=0.62s  peak_mem=5.5GB  tokens(total/prompt/gen)=1,439/1,430/9  gen_tps=131  prompt_tps=1,224
2025-11-20 17:17:16,791 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:16,791 - INFO - Processing Model [2/32]: [95mmeta-llama/Llama-3.2-11B-Vision-Instruct[0m
2025-11-20 17:17:16,791 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:17:16,791 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmeta-llama/Llama-3.2-11B-Vision-Instruct[0m
2025-11-20 17:17:16,941 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:18:58,073 - DEBUG - Cleaned up resources for model meta-llama/Llama-3.2-11B-Vision-Instruct
2025-11-20 17:18:58,075 - INFO - Quality analysis for meta-llama/Llama-3.2-11B-Vision-Instruct: excessive_bullets=True (count=38)
2025-11-20 17:18:58,075 - INFO - Quality issues detected for meta-llama/Llama-3.2-11B-Vision-Instruct: bullets(38)
2025-11-20 17:18:58,075 - INFO - [92m[RUN 2/32] SUMMARY model=meta-llama/Llama-3.2-11B-Vision-Instruct status=OK[0m
2025-11-20 17:18:58,075 - INFO - [92mtokens=612 prompt=237 gen=375 gen_tps=3.88 peak_mem=25GB total_time=101.25s[0m
2025-11-20 17:18:58,075 - INFO - [1m[92m✓ SUCCESS: [95mmeta-llama/Llama-3.2-11B-Vision-Instruct[0m[0m
2025-11-20 17:18:58,075 - INFO - 
2025-11-20 17:18:58,075 - INFO - Generated Text:
2025-11-20 17:18:58,075 - INFO -    **Image Description:**  * Image ID: 1234567890 * Image Title: "A Rainy Day in
2025-11-20 17:18:58,075 - INFO -    White Rock, Hastings, UK" * Category: Urban Landscapes * Location: White
2025-11-20 17:18:58,075 - INFO -    Rock, Hastings, East Sussex, UK * Date: November 15, 2025 * Time: 4:19 PM *
2025-11-20 17:18:58,075 - INFO -    Weather: Overcast and rainy * Camera: Canon EOS 5D Mark IV * Lens: 24-70mm
2025-11-20 17:18:58,075 - INFO -    f/2.8L II USM * ISO: 100 * Shutter Speed: 1/125s * Aperture: f/2.8 * Flash:
2025-11-20 17:18:58,075 - INFO -    Off * White Balance: Auto * Image Stabilization: Off  **Image Details:**  *
2025-11-20 17:18:58,075 - INFO -    The image features a rainy day scene in White Rock, Hastings, UK. * The scene
2025-11-20 17:18:58,076 - INFO -    is dominated by a row of buildings, with a few cars and people visible in the
2025-11-20 17:18:58,076 - INFO -    background. * The sky is overcast, and the ground is wet and reflective. *
2025-11-20 17:18:58,076 - INFO -    The image is taken from a low angle, looking up at the buildings. * The
2025-11-20 17:18:58,076 - INFO -    overall atmosphere is calm and peaceful, with a sense of stillness.  **Image
2025-11-20 17:18:58,076 - INFO -    Keywords:**  * Urban * Landscape * Rainy * Day * White Rock * Hastings * UK *
2025-11-20 17:18:58,076 - INFO -    Buildings * Cars * People * Overcast * Peaceful * Calm * Stillness  **Image
2025-11-20 17:18:58,076 - INFO -    Description:**  * The image captures a serene and peaceful scene of a rainy
2025-11-20 17:18:58,076 - INFO -    day in White Rock, Hastings, UK. * The overcast sky and wet ground create a
2025-11-20 17:18:58,076 - INFO -    calm and still atmosphere. * The image features a row of buildings and a few
2025-11-20 17:18:58,076 - INFO -    cars and people in the background. * The overall mood of the image is one of
2025-11-20 17:18:58,076 - INFO -    serenity and tranquility.
2025-11-20 17:18:58,076 - INFO - 
2025-11-20 17:18:58,076 - INFO - 
2025-11-20 17:18:58,076 - INFO - 📊 Metrics: total=101.25s  gen=99.95s  load=1.30s  peak_mem=25GB  tokens(total/prompt/gen)=612/237/375  gen_tps=3.88  prompt_tps=77.6
2025-11-20 17:18:58,076 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:18:58,076 - INFO - Processing Model [3/32]: [95mmicrosoft/Florence-2-large-ft[0m
2025-11-20 17:18:58,076 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:18:58,076 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmicrosoft/Florence-2-large-ft[0m
2025-11-20 17:18:58,241 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:18:58,392 - ERROR - Failed to load model microsoft/Florence-2-large-ft
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 296, in load
    model = load_model(model_path, lazy, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 225, in load_model
    model.load_weights(list(weights.items()))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/mlx/nn/layers/base.py", line 191, in load_weights
    raise ValueError(f"Missing {num_missing} parameters: \n{missing}.")
ValueError: Missing 1 parameters: 
language_model.lm_head.weight.
2025-11-20 17:18:58,419 - DEBUG - HF Cache Info for microsoft/Florence-2-large-ft: size=1472.1 MB, files=10
2025-11-20 17:18:58,419 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 296, in load
    model = load_model(model_path, lazy, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 225, in load_model
    model.load_weights(list(weights.items()))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/mlx/nn/layers/base.py", line 191, in load_weights
    raise ValueError(f"Missing {num_missing} parameters: \n{missing}.")
ValueError: Missing 1 parameters: 
language_model.lm_head.weight.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4555, in _run_model_generation
    raise ValueError(error_details) from load_err
ValueError: Model loading failed: Missing 1 parameters: 
language_model.lm_head.weight.
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 296, in load
    model = load_model(model_path, lazy, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 225, in load_model
    model.load_weights(list(weights.items()))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/mlx/nn/layers/base.py", line 191, in load_weights
    raise ValueError(f"Missing {num_missing} parameters: \n{missing}.")
ValueError: Missing 1 parameters: 
language_model.lm_head.weight.

2025-11-20 17:18:58,420 - DEBUG - Cleaned up resources for model microsoft/Florence-2-large-ft
2025-11-20 17:18:58,420 - ERROR - [91m[RUN 3/32] SUMMARY model=microsoft/Florence-2-large-ft status=FAIL stage=Model[0m
2025-11-20 17:18:58,420 - ERROR - [91mError error=Model loading failed: Missing 1 paramete…[0m
2025-11-20 17:18:58,420 - ERROR - [1m[91m✗ FAILED: [91mmicrosoft/Florence-2-large-ft[0m[0m
2025-11-20 17:18:58,421 - ERROR - Stage:
2025-11-20 17:18:58,421 - ERROR -   Model Error
2025-11-20 17:18:58,421 - ERROR - Error:
2025-11-20 17:18:58,421 - ERROR -   Model loading failed: Missing 1 parameters:
2025-11-20 17:18:58,421 - ERROR -   language_model.lm_head.weight.
2025-11-20 17:18:58,421 - ERROR -   Traceback (most recent call last):
2025-11-20 17:18:58,421 - ERROR -     File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540,
2025-11-20 17:18:58,421 - ERROR -   in _run_model_generation
2025-11-20 17:18:58,421 - ERROR -       model, tokenizer = load(
2025-11-20 17:18:58,421 - ERROR -                          ~~~~^
2025-11-20 17:18:58,421 - ERROR -           path_or_hf_repo=params.model_identifier,
2025-11-20 17:18:58,421 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:18:58,421 - ERROR -           lazy=params.lazy,
2025-11-20 17:18:58,421 - ERROR -           ^^^^^^^^^^^^^^^^^
2025-11-20 17:18:58,421 - ERROR -           trust_remote_code=params.trust_remote_code,
2025-11-20 17:18:58,421 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:18:58,421 - ERROR -       )
2025-11-20 17:18:58,421 - ERROR -       ^
2025-11-20 17:18:58,421 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 296, in
2025-11-20 17:18:58,421 - ERROR -   load
2025-11-20 17:18:58,421 - ERROR -       model = load_model(model_path, lazy, **kwargs)
2025-11-20 17:18:58,421 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 225, in
2025-11-20 17:18:58,421 - ERROR -   load_model
2025-11-20 17:18:58,421 - ERROR -       model.load_weights(list(weights.items()))
2025-11-20 17:18:58,421 - ERROR -       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:18:58,421 - ERROR -     File
2025-11-20 17:18:58,421 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/mlx/nn/layers/base.py",
2025-11-20 17:18:58,421 - ERROR -   line 191, in load_weights
2025-11-20 17:18:58,421 - ERROR -       raise ValueError(f"Missing {num_missing} parameters: \n{missing}.")
2025-11-20 17:18:58,421 - ERROR -   ValueError: Missing 1 parameters:
2025-11-20 17:18:58,421 - ERROR -   language_model.lm_head.weight.
2025-11-20 17:18:58,421 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:18:58,421 - INFO - Processing Model [4/32]: [95mmicrosoft/Phi-3.5-vision-instruct[0m
2025-11-20 17:18:58,421 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:18:58,421 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmicrosoft/Phi-3.5-vision-instruct[0m
2025-11-20 17:18:58,580 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:19:46,849 - DEBUG - Cleaned up resources for model microsoft/Phi-3.5-vision-instruct
2025-11-20 17:19:46,850 - INFO - Quality analysis for microsoft/Phi-3.5-vision-instruct: language_mixing=True, hallucination=True
2025-11-20 17:19:46,850 - INFO - Quality issues detected for microsoft/Phi-3.5-vision-instruct: lang_mixing, hallucination
2025-11-20 17:19:46,850 - INFO - [92m[RUN 4/32] SUMMARY model=microsoft/Phi-3.5-vision-instruct status=OK tokens=1542[0m
2025-11-20 17:19:46,850 - INFO - [92mprompt=1042 gen=500 gen_tps=11.1 peak_mem=12GB total_time=48.41s[0m
2025-11-20 17:19:46,850 - INFO - [1m[92m✓ SUCCESS: [95mmicrosoft/Phi-3.5-vision-instruct[0m[0m
2025-11-20 17:19:46,850 - INFO - 
2025-11-20 17:19:46,850 - INFO - Generated Text:
2025-11-20 17:19:46,850 - WARNING - ⚠️  Note:  Contains unexpected table
2025-11-20 17:19:46,850 - WARNING - ⚠️  Note:  Contains question/quiz content
2025-11-20 17:19:46,851 - INFO -    Caption: White Rock Seafront in Hastings, England - Late Autumn Evening.
2025-11-20 17:19:46,851 - INFO -    Description: The image depicts a serene evening scene at the White Rock
2025-11-20 17:19:46,851 - INFO -    seafront in Hastings, England. The perspective is from the ground level,
2025-11-20 17:19:46,851 - INFO -    showcasing the wet, reflective paving stones that glisten under the dimming
2025-11-20 17:19:46,851 - INFO -    light of the day. The sky is overcast, suggesting a cool, damp atmosphere
2025-11-20 17:19:46,851 - INFO -    typical of late autumn. In the distance, a row of modern residential
2025-11-20 17:19:46,851 - INFO -    buildings, including hotels and apartments, line the street, indicative of
2025-11-20 17:19:46,851 - INFO -    the area's development and its role as a coastal resort. The presence of a
2025-11-20 17:19:46,851 - INFO -    car's motion-blurred taillights in the background adds a dynamic element to
2025-11-20 17:19:46,851 - INFO -    the otherwise still and tranquil setting. The architecture and the wet
2025-11-20 17:19:46,851 - INFO -    pavement suggest that the photo was taken in the evening, possibly during the
2025-11-20 17:19:46,851 - INFO -    rainy season.  Keywords: White Rock, Hastings, England, seafront, late
2025-11-20 17:19:46,851 - INFO -    autumn, overcast sky, wet pavement, residential buildings, coastal resort,
2025-11-20 17:19:46,851 - INFO -    Victorian era development, tranquil evening, rainy
2025-11-20 17:19:46,851 - INFO -    season.<|end|><|endoftext|>    Here is a chart that shows the number of books
2025-11-20 17:19:46,851 - INFO -    read by students in a month.  | Student | Books Read |
2025-11-20 17:19:46,851 - INFO -    |---------|------------| | Alice   | 5          | | Bob     | 8          | |
2025-11-20 17:19:46,851 - INFO -    Carol   | 3          | | Dave    | 10         | | Eve     | 7          |
2025-11-20 17:19:46,851 - INFO -    Based on the chart, which student read the most books in a month?  A. Dave
2025-11-20 17:19:46,851 - INFO -    B. Bob  B. Carol  C. Eve  D. Alice<|end|><|endoftext|>    Here is a chart
2025-11-20 17:19:46,851 - INFO -    that shows the number of books read by students in a month.  | Student |
2025-11-20 17:19:46,851 - INFO -    Books Read | |---------|------------| | Alice   | 5          | | Bob     | 8
2025-11-20 17:19:46,851 - INFO -    | | Carol   | 3          | | Dave    | 10         | | Eve     | 7          |
2025-11-20 17:19:46,851 - INFO -    Based on the chart, which student read the most books in a month?  A. Dave
2025-11-20 17:19:46,851 - INFO -    B. Bob  B. Carol  C. Eve  D
2025-11-20 17:19:46,851 - INFO - 
2025-11-20 17:19:46,851 - INFO - 
2025-11-20 17:19:46,851 - INFO - 📊 Metrics: total=48.41s  gen=46.23s  load=2.19s  peak_mem=12GB  tokens(total/prompt/gen)=1,542/1,042/500  gen_tps=11.1  prompt_tps=925
2025-11-20 17:19:46,851 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:19:46,851 - INFO - Processing Model [5/32]: [95mmlx-community/Apriel-1.5-15b-Thinker-6bit-MLX[0m
2025-11-20 17:19:46,851 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:19:46,851 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Apriel-1.5-15b-Thinker-6bit-MLX[0m
2025-11-20 17:19:47,012 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:20:11,977 - DEBUG - Cleaned up resources for model mlx-community/Apriel-1.5-15b-Thinker-6bit-MLX
2025-11-20 17:20:11,978 - INFO - Quality analysis for mlx-community/Apriel-1.5-15b-Thinker-6bit-MLX: hallucination=True
2025-11-20 17:20:11,978 - INFO - Quality issues detected for mlx-community/Apriel-1.5-15b-Thinker-6bit-MLX: hallucination
2025-11-20 17:20:11,978 - INFO - [92m[RUN 5/32] SUMMARY model=mlx-community/Apriel-1.5-15b-Thinker-6bit-MLX status=OK[0m
2025-11-20 17:20:11,978 - INFO - [92mtokens=3433 prompt=2933 gen=500 gen_tps=34.4 peak_mem=15GB total_time=25.10s[0m
2025-11-20 17:20:11,978 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/Apriel-1.5-15b-Thinker-6bit-MLX[0m[0m
2025-11-20 17:20:11,978 - INFO - 
2025-11-20 17:20:11,979 - INFO - Generated Text:
2025-11-20 17:20:11,979 - WARNING - ⚠️  Note:  Contains question/quiz content
2025-11-20 17:20:11,979 - INFO -    Here are my reasoning steps: The user asks: "Provide a factual caption,
2025-11-20 17:20:11,979 - INFO -    description, and keywords suitable for cataloguing, or searching for, the
2025-11-20 17:20:11,979 - INFO -    image. Context: The image relates to ', White Rock, Hastings, England, United
2025-11-20 17:20:11,979 - INFO -    Kingdom, UK  Here is a caption for the image, written for the specified
2025-11-20 17:20:11,979 - INFO -    audience and context:  A damp, late autumn afternoon along the seafront at
2025-11-20 17:20:11,979 - INFO -    White Rock in Hastings, England. The low-angle perspective highlights the
2025-11-20 17:20:11,979 - INFO -    rain-slicked paving stones, which reflect the cool, overcast sky as dusk
2025-11-20 17:20:11,979 - INFO -    begins to fall. In the background, a row of hotels and apartments, typical of
2025-11-20 17:20:11,979 - INFO -    a British seaside town, lines the road. The motion blur of a passing car's
2025-11-20 17:20:11,979 - INFO -    taillights adds a streak of colour and a sense of movement to the otherwise
2025-11-20 17:20:11,979 - INFO -    quiet, atmospheric scene. This area was developed significantly during the
2025-11-20 17:20:11,979 - INFO -    Victorian era as Hastings grew into a popular coastal resort, and this image
2025-11-20 17:20:11,979 - INFO -    captures a modern, tranquil moment outside the peak tourist season.'  The
2025-11-20 17:20:11,979 - INFO -    photo was taken around 2025-11-15 16:19:28 GMT . Focus on visual content,
2025-11-20 17:20:11,979 - INFO -    drawing on any available contextual information for specificity. Do not
2025-11-20 17:20:11,979 - INFO -    speculate."  Thus the user wants a factual caption, description, and keywords
2025-11-20 17:20:11,979 - INFO -    suitable for cataloguing or searching for the image. They gave a sample
2025-11-20 17:20:11,979 - INFO -    caption but likely want a refined version. The user says "Provide a factual
2025-11-20 17:20:11,979 - INFO -    caption, description, and keywords suitable for cataloguing, or searching
2025-11-20 17:20:11,979 - INFO -    for, the image." So we need to produce a caption, a description, and a list
2025-11-20 17:20:11,979 - INFO -    of keywords. The context is White Rock, Hastings, England, UK. The image
2025-11-20 17:20:11,979 - INFO -    shows a rainy, overcast scene with concrete planters, wet pavement, white
2025-11-20 17:20:11,979 - INFO -    buildings, cars, etc. The user gave a sample caption but we need to produce a
2025-11-20 17:20:11,979 - INFO -    factual caption, description, and keywords. The user says "Focus on visual
2025-11-20 17:20:11,979 - INFO -    content, drawing on any available contextual information for specificity. Do
2025-11-20 17:20:11,979 - INFO -    not speculate." So we need to avoid speculation beyond what is visible. The
2025-11-20 17:20:11,979 - INFO -    sample caption includes historical context about Victorian era development,
2025-11-20 17:20:11,979 - INFO -    which is not visible in the image. That might be considered speculation. So
2025-11-20 17:20:11,979 - INFO -    we should avoid that. We should describe the visual content: wet pavement,
2025-11-20 17:20:11,979 - INFO -    concrete planters, white buildings, street, cars, streetlights, overcast sky,
2025-11-20 17:20:11,979 - INFO -    etc. Also mention location: White Rock, Hastings, UK. Provide a caption that
2025-11-20 17:20:11,979 - INFO -    is factual. Provide a description that is more detailed. Provide
2025-11-20 17:20:11,979 - INFO - 
2025-11-20 17:20:11,979 - INFO - 
2025-11-20 17:20:11,979 - INFO - 📊 Metrics: total=25.10s  gen=22.43s  load=2.67s  peak_mem=15GB  tokens(total/prompt/gen)=3,433/2,933/500  gen_tps=34.4  prompt_tps=390
2025-11-20 17:20:11,979 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:11,979 - INFO - Processing Model [6/32]: [95mmlx-community/Idefics3-8B-Llama3-bf16[0m
2025-11-20 17:20:11,979 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:11,979 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Idefics3-8B-Llama3-bf16[0m
2025-11-20 17:20:12,142 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:20:33,639 - DEBUG - Cleaned up resources for model mlx-community/Idefics3-8B-Llama3-bf16
2025-11-20 17:20:33,641 - INFO - Quality analysis for mlx-community/Idefics3-8B-Llama3-bf16: verbose=True, formatting_issues=True
2025-11-20 17:20:33,641 - INFO - Quality issues detected for mlx-community/Idefics3-8B-Llama3-bf16: verbose, formatting
2025-11-20 17:20:33,641 - INFO - [92m[RUN 6/32] SUMMARY model=mlx-community/Idefics3-8B-Llama3-bf16 status=OK[0m
2025-11-20 17:20:33,641 - INFO - [92mtokens=2966 prompt=2547 gen=419 gen_tps=29.1 peak_mem=19GB total_time=21.63s[0m
2025-11-20 17:20:33,641 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/Idefics3-8B-Llama3-bf16[0m[0m
2025-11-20 17:20:33,641 - INFO - 
2025-11-20 17:20:33,642 - INFO - Generated Text:
2025-11-20 17:20:33,642 - WARNING - ⚠️  Note: Output is excessively verbose (419 tokens)
2025-11-20 17:20:33,642 - WARNING - ⚠️  Note:  Unknown tags: &lt;end_of_utterance&gt;
2025-11-20 17:20:33,642 - INFO -    The image depicts a serene and slightly melancholic scene set in the seaside
2025-11-20 17:20:33,642 - INFO -    town of White Rock, Hastings, England, UK. The photograph captures a late
2025-11-20 17:20:33,642 - INFO -    autumn afternoon, characterized by a cool, overcast sky that casts a soft,
2025-11-20 17:20:33,642 - INFO -    diffused light over the scene. The low angle of the camera emphasizes the
2025-11-20 17:20:33,642 - INFO -    rain-slicked paving stones, which reflect the grey tones of the sky, creating
2025-11-20 17:20:33,642 - INFO -    a sense of calm and stillness. The wet pavement is a mosaic of black and grey
2025-11-20 17:20:33,642 - INFO -    tiles, with some areas showing signs of wear and age, contributing to the
2025-11-20 17:20:33,642 - INFO -    overall nostalgic and slightly melancholic atmosphere.  In the background, a
2025-11-20 17:20:33,642 - INFO -    row of buildings, typical of a British seaside town, lines the road. These
2025-11-20 17:20:33,642 - INFO -    buildings are predominantly white with some black accents, and they appear to
2025-11-20 17:20:33,642 - INFO -    be a mix of hotels and apartments. The architecture is classic and somewhat
2025-11-20 17:20:33,642 - INFO -    vintage, suggesting that this area was developed during the Victorian era
2025-11-20 17:20:33,642 - INFO -    when Hastings grew into a popular coastal resort. The buildings have multiple
2025-11-20 17:20:33,642 - INFO -    stories, with balconies and windows that are either open or closed, hinting
2025-11-20 17:20:33,642 - INFO -    at the changing weather conditions.  A single car is visible in the
2025-11-20 17:20:33,643 - INFO -    background, moving away from the camera. The motion blur of the car's
2025-11-20 17:20:33,643 - INFO -    taillights adds a streak of colour and a sense of movement to the otherwise
2025-11-20 17:20:33,643 - INFO -    tranquil scene. The car's presence indicates that the area is still
2025-11-20 17:20:33,643 - INFO -    frequented by visitors, even during the off-season.  The overall mood of the
2025-11-20 17:20:33,643 - INFO -    image is one of quiet contemplation and nostalgia. The combination of the
2025-11-20 17:20:33,643 - INFO -    rain, the overcast sky, and the vintage architecture creates a sense of
2025-11-20 17:20:33,643 - INFO -    timelessness, as if the scene could have been captured decades ago. The image
2025-11-20 17:20:33,643 - INFO -    captures a moment of peace and solitude, away from the hustle and bustle of
2025-11-20 17:20:33,643 - INFO -    daily life, inviting the viewer to reflect on the beauty of a bygone era.  In
2025-11-20 17:20:33,643 - INFO -    summary, the image is a poignant portrayal of a seaside town in England,
2025-11-20 17:20:33,643 - INFO -    capturing the essence of a quiet, autumn afternoon. The rain-slicked
2025-11-20 17:20:33,643 - INFO -    pavement, vintage architecture, and the solitary car create a nostalgic and
2025-11-20 17:20:33,643 - INFO -    contemplative atmosphere, evoking a sense of timelessness and
2025-11-20 17:20:33,643 - INFO -    peace.<end_of_utterance>
2025-11-20 17:20:33,643 - INFO - 
2025-11-20 17:20:33,643 - INFO - 
2025-11-20 17:20:33,643 - INFO - 📊 Metrics: total=21.63s  gen=18.41s  load=3.22s  peak_mem=19GB  tokens(total/prompt/gen)=2,966/2,547/419  gen_tps=29.1  prompt_tps=712
2025-11-20 17:20:33,643 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:33,643 - INFO - Processing Model [7/32]: [95mmlx-community/InternVL3-14B-8bit[0m
2025-11-20 17:20:33,643 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:33,643 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/InternVL3-14B-8bit[0m
2025-11-20 17:20:33,804 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:20:53,259 - DEBUG - Cleaned up resources for model mlx-community/InternVL3-14B-8bit
2025-11-20 17:20:53,261 - INFO - Quality analysis for mlx-community/InternVL3-14B-8bit: excessive_bullets=True (count=18)
2025-11-20 17:20:53,261 - INFO - Quality issues detected for mlx-community/InternVL3-14B-8bit: bullets(18)
2025-11-20 17:20:53,261 - INFO - [92m[RUN 7/32] SUMMARY model=mlx-community/InternVL3-14B-8bit status=OK tokens=2327[0m
2025-11-20 17:20:53,261 - INFO - [92mprompt=2032 gen=295 gen_tps=27.8 peak_mem=18GB total_time=19.59s[0m
2025-11-20 17:20:53,261 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/InternVL3-14B-8bit[0m[0m
2025-11-20 17:20:53,261 - INFO - 
2025-11-20 17:20:53,262 - INFO - Generated Text:
2025-11-20 17:20:53,262 - INFO -    **Caption:** A tranquil scene at White Rock, Hastings, England, on a damp,
2025-11-20 17:20:53,262 - INFO -    late afternoon. The rain-slicked paving stones reflect the overcast sky as
2025-11-20 17:20:53,262 - INFO -    dusk approaches. In the background, a row of hotels and apartments lines the
2025-11-20 17:20:53,262 - INFO -    road, with the motion blur of passing cars adding a touch of movement. This
2025-11-20 17:20:53,262 - INFO -    area, developed during the Victorian era, captures a quiet moment outside the
2025-11-20 17:20:53,262 - INFO -    peak tourist season.  **Description:** The image depicts a serene seaside
2025-11-20 17:20:53,262 - INFO -    promenade at White Rock, Hastings, England. The foreground features
2025-11-20 17:20:53,262 - INFO -    rain-slicked paving stones reflecting the subdued light of the overcast sky.
2025-11-20 17:20:53,262 - INFO -    Several concrete planters, showing signs of weathering, are scattered across
2025-11-20 17:20:53,262 - INFO -    the wet pavement. In the background, a row of multi-story hotels and
2025-11-20 17:20:53,262 - INFO -    apartments, typical of a British seaside town, lines the street. The
2025-11-20 17:20:53,262 - INFO -    buildings are predominantly white with some featuring balconies. The motion
2025-11-20 17:20:53,262 - INFO -    blur of passing cars, particularly noticeable in the taillights, adds a
2025-11-20 17:20:53,262 - INFO -    dynamic element to the otherwise calm scene. The atmosphere suggests a quiet,
2025-11-20 17:20:53,262 - INFO -    late autumn afternoon as dusk begins to set in.  **Keywords:** - White Rock -
2025-11-20 17:20:53,262 - INFO -    Hastings - England - UK - Seafront - Rain-slicked pavement - Concrete
2025-11-20 17:20:53,262 - INFO -    planters - Hotels - Apartments - Victorian era - Seaside town - Overcast sky
2025-11-20 17:20:53,262 - INFO -    - Dusk - Motion blur - Passing cars - Quiet atmosphere - Late autumn -
2025-11-20 17:20:53,262 - INFO -    British coastal resort
2025-11-20 17:20:53,262 - INFO - 
2025-11-20 17:20:53,262 - INFO - 
2025-11-20 17:20:53,262 - INFO - 📊 Metrics: total=19.59s  gen=16.59s  load=3.00s  peak_mem=18GB  tokens(total/prompt/gen)=2,327/2,032/295  gen_tps=27.8  prompt_tps=363
2025-11-20 17:20:53,262 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:53,262 - INFO - Processing Model [8/32]: [95mmlx-community/Kimi-VL-A3B-Thinking-2506-bf16[0m
2025-11-20 17:20:53,262 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:53,262 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Kimi-VL-A3B-Thinking-2506-bf16[0m
2025-11-20 17:20:53,424 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:20:58,437 - ERROR - Failed to load model mlx-community/Kimi-VL-A3B-Thinking-2506-bf16
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/a04b2b044b1795d3e56eeee0d4946ca0c3a9d0fc/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
2025-11-20 17:20:58,529 - DEBUG - HF Cache Info for mlx-community/Kimi-VL-A3B-Thinking-2506-bf16: size=31298.6 MB, files=23
2025-11-20 17:20:58,529 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/a04b2b044b1795d3e56eeee0d4946ca0c3a9d0fc/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4555, in _run_model_generation
    raise ValueError(error_details) from load_err
ValueError: Model loading failed: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/a04b2b044b1795d3e56eeee0d4946ca0c3a9d0fc/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)

2025-11-20 17:20:58,592 - DEBUG - Cleaned up resources for model mlx-community/Kimi-VL-A3B-Thinking-2506-bf16
2025-11-20 17:20:58,592 - ERROR - [91m[RUN 8/32] SUMMARY model=mlx-community/Kimi-VL-A3B-Thinking-2506-bf16[0m
2025-11-20 17:20:58,592 - ERROR - [91mstatus=FAIL stage=Lib Version error=Model loading failed: cannot import name…[0m
2025-11-20 17:20:58,592 - ERROR - [1m[91m✗ FAILED: [91mmlx-community/Kimi-VL-A3B-Thinking-2506-bf16[0m[0m
2025-11-20 17:20:58,592 - ERROR - Stage:
2025-11-20 17:20:58,592 - ERROR -   Lib Version
2025-11-20 17:20:58,592 - ERROR - Error:
2025-11-20 17:20:58,592 - ERROR -   Model loading failed: cannot import name '_validate_images_text_input_order'
2025-11-20 17:20:58,592 - ERROR -   from 'transformers.processing_utils'
2025-11-20 17:20:58,592 - ERROR -   (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
2025-11-20 17:20:58,592 - ERROR -   Traceback (most recent call last):
2025-11-20 17:20:58,592 - ERROR -     File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540,
2025-11-20 17:20:58,592 - ERROR -   in _run_model_generation
2025-11-20 17:20:58,592 - ERROR -       model, tokenizer = load(
2025-11-20 17:20:58,592 - ERROR -                          ~~~~^
2025-11-20 17:20:58,592 - ERROR -           path_or_hf_repo=params.model_identifier,
2025-11-20 17:20:58,592 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:20:58,592 - ERROR -           lazy=params.lazy,
2025-11-20 17:20:58,592 - ERROR -           ^^^^^^^^^^^^^^^^^
2025-11-20 17:20:58,592 - ERROR -           trust_remote_code=params.trust_remote_code,
2025-11-20 17:20:58,592 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:20:58,592 - ERROR -       )
2025-11-20 17:20:58,592 - ERROR -       ^
2025-11-20 17:20:58,592 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in
2025-11-20 17:20:58,593 - ERROR -   load
2025-11-20 17:20:58,593 - ERROR -       processor = load_processor(model_path, True, eos_token_ids=eos_token_id,
2025-11-20 17:20:58,593 - ERROR -   **kwargs)
2025-11-20 17:20:58,593 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in
2025-11-20 17:20:58,593 - ERROR -   load_processor
2025-11-20 17:20:58,593 - ERROR -       processor = AutoProcessor.from_pretrained(model_path, **kwargs)
2025-11-20 17:20:58,593 - ERROR -     File
2025-11-20 17:20:58,593 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py",
2025-11-20 17:20:58,593 - ERROR -   line 387, in from_pretrained
2025-11-20 17:20:58,593 - ERROR -       processor_class = get_class_from_dynamic_module(
2025-11-20 17:20:58,593 - ERROR -           processor_auto_map, pretrained_model_name_or_path, **kwargs
2025-11-20 17:20:58,593 - ERROR -       )
2025-11-20 17:20:58,593 - ERROR -     File
2025-11-20 17:20:58,593 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:20:58,593 - ERROR -   line 616, in get_class_from_dynamic_module
2025-11-20 17:20:58,593 - ERROR -       return get_class_in_module(class_name, final_module,
2025-11-20 17:20:58,593 - ERROR -   force_reload=force_download)
2025-11-20 17:20:58,593 - ERROR -     File
2025-11-20 17:20:58,593 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:20:58,593 - ERROR -   line 311, in get_class_in_module
2025-11-20 17:20:58,593 - ERROR -       module_spec.loader.exec_module(module)
2025-11-20 17:20:58,593 - ERROR -       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
2025-11-20 17:20:58,593 - ERROR -     File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
2025-11-20 17:20:58,593 - ERROR -     File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
2025-11-20 17:20:58,593 - ERROR -     File
2025-11-20 17:20:58,593 - ERROR -   "/Users/jrp/.cache/huggingface/modules/transformers_modules/a04b2b044b1795d3e56eeee0d4946ca0c3a9d0fc/processing_kimi_vl.py",
2025-11-20 17:20:58,593 - ERROR -   line 25, in <module>
2025-11-20 17:20:58,593 - ERROR -       from transformers.processing_utils import ProcessingKwargs,
2025-11-20 17:20:58,593 - ERROR -   ProcessorMixin, Unpack, _validate_images_text_input_order
2025-11-20 17:20:58,593 - ERROR -   ImportError: cannot import name '_validate_images_text_input_order' from
2025-11-20 17:20:58,593 - ERROR -   'transformers.processing_utils'
2025-11-20 17:20:58,593 - ERROR -   (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
2025-11-20 17:20:58,593 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:58,593 - INFO - Processing Model [9/32]: [95mmlx-community/Kimi-VL-A3B-Thinking-8bit[0m
2025-11-20 17:20:58,593 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:20:58,593 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Kimi-VL-A3B-Thinking-8bit[0m
2025-11-20 17:20:58,764 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:21:00,862 - ERROR - Failed to load model mlx-community/Kimi-VL-A3B-Thinking-8bit
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/b5f89e575e95a48394b3d708beff29b842a4e14c/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
2025-11-20 17:21:00,944 - DEBUG - HF Cache Info for mlx-community/Kimi-VL-A3B-Thinking-8bit: size=17004.9 MB, files=17
2025-11-20 17:21:00,944 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/b5f89e575e95a48394b3d708beff29b842a4e14c/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4555, in _run_model_generation
    raise ValueError(error_details) from load_err
ValueError: Model loading failed: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/b5f89e575e95a48394b3d708beff29b842a4e14c/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)

2025-11-20 17:21:01,008 - DEBUG - Cleaned up resources for model mlx-community/Kimi-VL-A3B-Thinking-8bit
2025-11-20 17:21:01,008 - ERROR - [91m[RUN 9/32] SUMMARY model=mlx-community/Kimi-VL-A3B-Thinking-8bit status=FAIL[0m
2025-11-20 17:21:01,008 - ERROR - [91mstage=Lib Version error=Model loading failed: cannot import name…[0m
2025-11-20 17:21:01,008 - ERROR - [1m[91m✗ FAILED: [91mmlx-community/Kimi-VL-A3B-Thinking-8bit[0m[0m
2025-11-20 17:21:01,008 - ERROR - Stage:
2025-11-20 17:21:01,008 - ERROR -   Lib Version
2025-11-20 17:21:01,008 - ERROR - Error:
2025-11-20 17:21:01,008 - ERROR -   Model loading failed: cannot import name '_validate_images_text_input_order'
2025-11-20 17:21:01,008 - ERROR -   from 'transformers.processing_utils'
2025-11-20 17:21:01,008 - ERROR -   (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
2025-11-20 17:21:01,008 - ERROR -   Traceback (most recent call last):
2025-11-20 17:21:01,008 - ERROR -     File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540,
2025-11-20 17:21:01,008 - ERROR -   in _run_model_generation
2025-11-20 17:21:01,008 - ERROR -       model, tokenizer = load(
2025-11-20 17:21:01,008 - ERROR -                          ~~~~^
2025-11-20 17:21:01,008 - ERROR -           path_or_hf_repo=params.model_identifier,
2025-11-20 17:21:01,008 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:01,008 - ERROR -           lazy=params.lazy,
2025-11-20 17:21:01,008 - ERROR -           ^^^^^^^^^^^^^^^^^
2025-11-20 17:21:01,008 - ERROR -           trust_remote_code=params.trust_remote_code,
2025-11-20 17:21:01,008 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:01,008 - ERROR -       )
2025-11-20 17:21:01,008 - ERROR -       ^
2025-11-20 17:21:01,008 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in
2025-11-20 17:21:01,008 - ERROR -   load
2025-11-20 17:21:01,008 - ERROR -       processor = load_processor(model_path, True, eos_token_ids=eos_token_id,
2025-11-20 17:21:01,008 - ERROR -   **kwargs)
2025-11-20 17:21:01,008 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in
2025-11-20 17:21:01,008 - ERROR -   load_processor
2025-11-20 17:21:01,008 - ERROR -       processor = AutoProcessor.from_pretrained(model_path, **kwargs)
2025-11-20 17:21:01,008 - ERROR -     File
2025-11-20 17:21:01,008 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py",
2025-11-20 17:21:01,008 - ERROR -   line 387, in from_pretrained
2025-11-20 17:21:01,008 - ERROR -       processor_class = get_class_from_dynamic_module(
2025-11-20 17:21:01,008 - ERROR -           processor_auto_map, pretrained_model_name_or_path, **kwargs
2025-11-20 17:21:01,008 - ERROR -       )
2025-11-20 17:21:01,008 - ERROR -     File
2025-11-20 17:21:01,008 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:01,008 - ERROR -   line 616, in get_class_from_dynamic_module
2025-11-20 17:21:01,008 - ERROR -       return get_class_in_module(class_name, final_module,
2025-11-20 17:21:01,008 - ERROR -   force_reload=force_download)
2025-11-20 17:21:01,008 - ERROR -     File
2025-11-20 17:21:01,008 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:01,008 - ERROR -   line 311, in get_class_in_module
2025-11-20 17:21:01,008 - ERROR -       module_spec.loader.exec_module(module)
2025-11-20 17:21:01,008 - ERROR -       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
2025-11-20 17:21:01,008 - ERROR -     File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
2025-11-20 17:21:01,008 - ERROR -     File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
2025-11-20 17:21:01,008 - ERROR -     File
2025-11-20 17:21:01,008 - ERROR -   "/Users/jrp/.cache/huggingface/modules/transformers_modules/b5f89e575e95a48394b3d708beff29b842a4e14c/processing_kimi_vl.py",
2025-11-20 17:21:01,009 - ERROR -   line 25, in <module>
2025-11-20 17:21:01,009 - ERROR -       from transformers.processing_utils import ProcessingKwargs,
2025-11-20 17:21:01,009 - ERROR -   ProcessorMixin, Unpack, _validate_images_text_input_order
2025-11-20 17:21:01,009 - ERROR -   ImportError: cannot import name '_validate_images_text_input_order' from
2025-11-20 17:21:01,009 - ERROR -   'transformers.processing_utils'
2025-11-20 17:21:01,009 - ERROR -   (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
2025-11-20 17:21:01,009 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:01,009 - INFO - Processing Model [10/32]: [95mmlx-community/LFM2-VL-1.6B-8bit[0m
2025-11-20 17:21:01,009 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:01,009 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/LFM2-VL-1.6B-8bit[0m
2025-11-20 17:21:01,184 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:21:06,657 - DEBUG - Cleaned up resources for model mlx-community/LFM2-VL-1.6B-8bit
2025-11-20 17:21:06,658 - INFO - Quality analysis for mlx-community/LFM2-VL-1.6B-8bit: no issues detected
2025-11-20 17:21:06,658 - INFO - [92m[RUN 10/32] SUMMARY model=mlx-community/LFM2-VL-1.6B-8bit status=OK tokens=2272[0m
2025-11-20 17:21:06,658 - INFO - [92mprompt=2029 gen=243 gen_tps=288 peak_mem=53GB total_time=5.64s[0m
2025-11-20 17:21:06,658 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/LFM2-VL-1.6B-8bit[0m[0m
2025-11-20 17:21:06,658 - INFO - 
2025-11-20 17:21:06,659 - INFO - Generated Text:
2025-11-20 17:21:06,659 - INFO -    Caption: "Damp, late autumn afternoon at White Rock, Hastings, England.
2025-11-20 17:21:06,659 - INFO -    Rain-slicked paving stones reflect the overcast sky as dusk falls. Modern,
2025-11-20 17:21:06,659 - INFO -    tranquil scene outside the peak tourist season."  Description: The image
2025-11-20 17:21:06,659 - INFO -    captures a damp, late autumn afternoon along the seafront at White Rock in
2025-11-20 17:21:06,659 - INFO -    Hastings, England. The low-angle perspective highlights the rain-slicked
2025-11-20 17:21:06,659 - INFO -    paving stones, which reflect the cool, overcast sky as dusk begins to fall.
2025-11-20 17:21:06,659 - INFO -    In the background, a row of hotels and apartments, typical of a British
2025-11-20 17:21:06,659 - INFO -    seaside town, lines the road. The motion blur of a passing car's taillights
2025-11-20 17:21:06,659 - INFO -    adds a streak of color and a sense of movement to the otherwise quiet,
2025-11-20 17:21:06,659 - INFO -    atmospheric scene. This area was developed significantly during the Victorian
2025-11-20 17:21:06,659 - INFO -    era as Hastings grew into a popular coastal resort, and this image captures a
2025-11-20 17:21:06,659 - INFO -    modern, tranquil moment outside the peak tourist season.  Keywords: White
2025-11-20 17:21:06,659 - INFO -    Rock, Hastings, England, United Kingdom, UK, seaside town, Victorian era,
2025-11-20 17:21:06,659 - INFO -    Victorian development, rainy, autumn, paving stones, overcast sky, dusk,
2025-11-20 17:21:06,659 - INFO -    modern, tranquil, tourist season, motion blur, car taillights.
2025-11-20 17:21:06,659 - INFO - 
2025-11-20 17:21:06,659 - INFO - 
2025-11-20 17:21:06,659 - INFO - 📊 Metrics: total=5.64s  gen=4.51s  load=1.12s  peak_mem=53GB  tokens(total/prompt/gen)=2,272/2,029/243  gen_tps=288  prompt_tps=631
2025-11-20 17:21:06,659 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:06,659 - INFO - Processing Model [11/32]: [95mmlx-community/Llama-3.2-11B-Vision-Instruct-8bit[0m
2025-11-20 17:21:06,659 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:06,659 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Llama-3.2-11B-Vision-Instruct-8bit[0m
2025-11-20 17:21:06,828 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:21:33,492 - DEBUG - Cleaned up resources for model mlx-community/Llama-3.2-11B-Vision-Instruct-8bit
2025-11-20 17:21:33,493 - INFO - Quality analysis for mlx-community/Llama-3.2-11B-Vision-Instruct-8bit: context_ignored=True
2025-11-20 17:21:33,493 - INFO - Quality issues detected for mlx-community/Llama-3.2-11B-Vision-Instruct-8bit: context-ignored
2025-11-20 17:21:33,493 - INFO - [92m[RUN 11/32] SUMMARY model=mlx-community/Llama-3.2-11B-Vision-Instruct-8bit[0m
2025-11-20 17:21:33,493 - INFO - [92mstatus=OK tokens=395 prompt=236 gen=159 gen_tps=7.73 peak_mem=48GB[0m
2025-11-20 17:21:33,493 - INFO - [92mtotal_time=26.81s[0m
2025-11-20 17:21:33,493 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/Llama-3.2-11B-Vision-Instruct-8bit[0m[0m
2025-11-20 17:21:33,493 - INFO - 
2025-11-20 17:21:33,494 - INFO - Generated Text:
2025-11-20 17:21:33,494 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock)
2025-11-20 17:21:33,494 - INFO -    I'm happy to help you with your question, but I have to say that I'm a bit
2025-11-20 17:21:33,494 - INFO -    confused by the content of your message. It seems like you're trying to
2025-11-20 17:21:33,494 - INFO -    provide a factual caption for an image, but the image itself is not visible
2025-11-20 17:21:33,494 - INFO -    to me. Additionally, the text you've provided appears to be a jumbled
2025-11-20 17:21:33,494 - INFO -    collection of words and phrases that don't seem to be related to each other.
2025-11-20 17:21:33,494 - INFO -    If you could provide more context or clarify what you're trying to say, I'd
2025-11-20 17:21:33,494 - INFO -    be happy to try and help you. Alternatively, if you could provide a clear and
2025-11-20 17:21:33,494 - INFO -    concise description of the image you're trying to caption, I'd be happy to
2025-11-20 17:21:33,494 - INFO -    try and assist you in creating a factual and informative caption.  Please let
2025-11-20 17:21:33,494 - INFO -    me know if there's anything else I can help with.
2025-11-20 17:21:33,494 - INFO - 
2025-11-20 17:21:33,494 - INFO - 
2025-11-20 17:21:33,494 - INFO - 📊 Metrics: total=26.81s  gen=24.13s  load=2.68s  peak_mem=48GB  tokens(total/prompt/gen)=395/236/159  gen_tps=7.73  prompt_tps=72.8
2025-11-20 17:21:33,494 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:33,494 - INFO - Processing Model [12/32]: [95mmlx-community/Molmo-7B-D-0924-8bit[0m
2025-11-20 17:21:33,494 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:33,494 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Molmo-7B-D-0924-8bit[0m
2025-11-20 17:21:33,655 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:21:35,156 - ERROR - Failed to load model mlx-community/Molmo-7B-D-0924-8bit
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
2025-11-20 17:21:35,179 - DEBUG - HF Cache Info for mlx-community/Molmo-7B-D-0924-8bit: size=8632.6 MB, files=16
2025-11-20 17:21:35,179 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4555, in _run_model_generation
    raise ValueError(error_details) from load_err
ValueError: Model loading failed: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`

2025-11-20 17:21:35,181 - DEBUG - Cleaned up resources for model mlx-community/Molmo-7B-D-0924-8bit
2025-11-20 17:21:35,181 - ERROR - [91m[RUN 12/32] SUMMARY model=mlx-community/Molmo-7B-D-0924-8bit status=FAIL[0m
2025-11-20 17:21:35,181 - ERROR - [91mstage=Missing Dep error=Model loading failed: This modeling file…[0m
2025-11-20 17:21:35,181 - ERROR - [1m[91m✗ FAILED: [91mmlx-community/Molmo-7B-D-0924-8bit[0m[0m
2025-11-20 17:21:35,181 - ERROR - Stage:
2025-11-20 17:21:35,181 - ERROR -   Missing Dep
2025-11-20 17:21:35,181 - ERROR - Error:
2025-11-20 17:21:35,181 - ERROR -   Model loading failed: This modeling file requires the following packages that
2025-11-20 17:21:35,181 - ERROR -   were not found in your environment: tensorflow. Run `pip install tensorflow`
2025-11-20 17:21:35,181 - ERROR -   Traceback (most recent call last):
2025-11-20 17:21:35,181 - ERROR -     File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540,
2025-11-20 17:21:35,181 - ERROR -   in _run_model_generation
2025-11-20 17:21:35,181 - ERROR -       model, tokenizer = load(
2025-11-20 17:21:35,181 - ERROR -                          ~~~~^
2025-11-20 17:21:35,181 - ERROR -           path_or_hf_repo=params.model_identifier,
2025-11-20 17:21:35,181 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:35,181 - ERROR -           lazy=params.lazy,
2025-11-20 17:21:35,181 - ERROR -           ^^^^^^^^^^^^^^^^^
2025-11-20 17:21:35,181 - ERROR -           trust_remote_code=params.trust_remote_code,
2025-11-20 17:21:35,182 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:35,182 - ERROR -       )
2025-11-20 17:21:35,182 - ERROR -       ^
2025-11-20 17:21:35,182 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in
2025-11-20 17:21:35,182 - ERROR -   load
2025-11-20 17:21:35,182 - ERROR -       processor = load_processor(model_path, True, eos_token_ids=eos_token_id,
2025-11-20 17:21:35,182 - ERROR -   **kwargs)
2025-11-20 17:21:35,182 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in
2025-11-20 17:21:35,182 - ERROR -   load_processor
2025-11-20 17:21:35,182 - ERROR -       processor = AutoProcessor.from_pretrained(model_path, **kwargs)
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py",
2025-11-20 17:21:35,182 - ERROR -   line 392, in from_pretrained
2025-11-20 17:21:35,182 - ERROR -       return processor_class.from_pretrained(
2025-11-20 17:21:35,182 - ERROR -              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
2025-11-20 17:21:35,182 - ERROR -           pretrained_model_name_or_path, trust_remote_code=trust_remote_code,
2025-11-20 17:21:35,182 - ERROR -   **kwargs
2025-11-20 17:21:35,182 - ERROR -   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:35,182 - ERROR -       )
2025-11-20 17:21:35,182 - ERROR -       ^
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py",
2025-11-20 17:21:35,182 - ERROR -   line 1394, in from_pretrained
2025-11-20 17:21:35,182 - ERROR -       args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path,
2025-11-20 17:21:35,182 - ERROR -   **kwargs)
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py",
2025-11-20 17:21:35,182 - ERROR -   line 1453, in _get_arguments_from_pretrained
2025-11-20 17:21:35,182 - ERROR -       args.append(attribute_class.from_pretrained(pretrained_model_name_or_path,
2025-11-20 17:21:35,182 - ERROR -   **kwargs))
2025-11-20 17:21:35,182 - ERROR -   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py",
2025-11-20 17:21:35,182 - ERROR -   line 598, in from_pretrained
2025-11-20 17:21:35,182 - ERROR -       image_processor_class = get_class_from_dynamic_module(class_ref,
2025-11-20 17:21:35,182 - ERROR -   pretrained_model_name_or_path, **kwargs)
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:35,182 - ERROR -   line 604, in get_class_from_dynamic_module
2025-11-20 17:21:35,182 - ERROR -       final_module = get_cached_module_file(
2025-11-20 17:21:35,182 - ERROR -           repo_id,
2025-11-20 17:21:35,182 - ERROR -       ...<8 lines>...
2025-11-20 17:21:35,182 - ERROR -           repo_type=repo_type,
2025-11-20 17:21:35,182 - ERROR -       )
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:35,182 - ERROR -   line 427, in get_cached_module_file
2025-11-20 17:21:35,182 - ERROR -       modules_needed = check_imports(resolved_module_file)
2025-11-20 17:21:35,182 - ERROR -     File
2025-11-20 17:21:35,182 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:35,182 - ERROR -   line 260, in check_imports
2025-11-20 17:21:35,182 - ERROR -       raise ImportError(
2025-11-20 17:21:35,182 - ERROR -       ...<2 lines>...
2025-11-20 17:21:35,182 - ERROR -       )
2025-11-20 17:21:35,182 - ERROR -   ImportError: This modeling file requires the following packages that were not
2025-11-20 17:21:35,182 - ERROR -   found in your environment: tensorflow. Run `pip install tensorflow`
2025-11-20 17:21:35,182 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:35,182 - INFO - Processing Model [13/32]: [95mmlx-community/Molmo-7B-D-0924-bf16[0m
2025-11-20 17:21:35,182 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:35,182 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Molmo-7B-D-0924-bf16[0m
2025-11-20 17:21:35,342 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:21:37,850 - ERROR - Failed to load model mlx-community/Molmo-7B-D-0924-bf16
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
2025-11-20 17:21:37,868 - DEBUG - HF Cache Info for mlx-community/Molmo-7B-D-0924-bf16: size=15314.5 MB, files=18
2025-11-20 17:21:37,868 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4555, in _run_model_generation
    raise ValueError(error_details) from load_err
ValueError: Model loading failed: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`

2025-11-20 17:21:37,870 - DEBUG - Cleaned up resources for model mlx-community/Molmo-7B-D-0924-bf16
2025-11-20 17:21:37,870 - ERROR - [91m[RUN 13/32] SUMMARY model=mlx-community/Molmo-7B-D-0924-bf16 status=FAIL[0m
2025-11-20 17:21:37,870 - ERROR - [91mstage=Missing Dep error=Model loading failed: This modeling file…[0m
2025-11-20 17:21:37,870 - ERROR - [1m[91m✗ FAILED: [91mmlx-community/Molmo-7B-D-0924-bf16[0m[0m
2025-11-20 17:21:37,870 - ERROR - Stage:
2025-11-20 17:21:37,870 - ERROR -   Missing Dep
2025-11-20 17:21:37,870 - ERROR - Error:
2025-11-20 17:21:37,870 - ERROR -   Model loading failed: This modeling file requires the following packages that
2025-11-20 17:21:37,870 - ERROR -   were not found in your environment: tensorflow. Run `pip install tensorflow`
2025-11-20 17:21:37,870 - ERROR -   Traceback (most recent call last):
2025-11-20 17:21:37,870 - ERROR -     File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540,
2025-11-20 17:21:37,870 - ERROR -   in _run_model_generation
2025-11-20 17:21:37,870 - ERROR -       model, tokenizer = load(
2025-11-20 17:21:37,871 - ERROR -                          ~~~~^
2025-11-20 17:21:37,871 - ERROR -           path_or_hf_repo=params.model_identifier,
2025-11-20 17:21:37,871 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:37,871 - ERROR -           lazy=params.lazy,
2025-11-20 17:21:37,871 - ERROR -           ^^^^^^^^^^^^^^^^^
2025-11-20 17:21:37,871 - ERROR -           trust_remote_code=params.trust_remote_code,
2025-11-20 17:21:37,871 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:37,871 - ERROR -       )
2025-11-20 17:21:37,871 - ERROR -       ^
2025-11-20 17:21:37,871 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in
2025-11-20 17:21:37,871 - ERROR -   load
2025-11-20 17:21:37,871 - ERROR -       processor = load_processor(model_path, True, eos_token_ids=eos_token_id,
2025-11-20 17:21:37,871 - ERROR -   **kwargs)
2025-11-20 17:21:37,871 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in
2025-11-20 17:21:37,871 - ERROR -   load_processor
2025-11-20 17:21:37,871 - ERROR -       processor = AutoProcessor.from_pretrained(model_path, **kwargs)
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py",
2025-11-20 17:21:37,871 - ERROR -   line 392, in from_pretrained
2025-11-20 17:21:37,871 - ERROR -       return processor_class.from_pretrained(
2025-11-20 17:21:37,871 - ERROR -              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
2025-11-20 17:21:37,871 - ERROR -           pretrained_model_name_or_path, trust_remote_code=trust_remote_code,
2025-11-20 17:21:37,871 - ERROR -   **kwargs
2025-11-20 17:21:37,871 - ERROR -   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:37,871 - ERROR -       )
2025-11-20 17:21:37,871 - ERROR -       ^
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py",
2025-11-20 17:21:37,871 - ERROR -   line 1394, in from_pretrained
2025-11-20 17:21:37,871 - ERROR -       args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path,
2025-11-20 17:21:37,871 - ERROR -   **kwargs)
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py",
2025-11-20 17:21:37,871 - ERROR -   line 1453, in _get_arguments_from_pretrained
2025-11-20 17:21:37,871 - ERROR -       args.append(attribute_class.from_pretrained(pretrained_model_name_or_path,
2025-11-20 17:21:37,871 - ERROR -   **kwargs))
2025-11-20 17:21:37,871 - ERROR -   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py",
2025-11-20 17:21:37,871 - ERROR -   line 598, in from_pretrained
2025-11-20 17:21:37,871 - ERROR -       image_processor_class = get_class_from_dynamic_module(class_ref,
2025-11-20 17:21:37,871 - ERROR -   pretrained_model_name_or_path, **kwargs)
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:37,871 - ERROR -   line 604, in get_class_from_dynamic_module
2025-11-20 17:21:37,871 - ERROR -       final_module = get_cached_module_file(
2025-11-20 17:21:37,871 - ERROR -           repo_id,
2025-11-20 17:21:37,871 - ERROR -       ...<8 lines>...
2025-11-20 17:21:37,871 - ERROR -           repo_type=repo_type,
2025-11-20 17:21:37,871 - ERROR -       )
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:37,871 - ERROR -   line 427, in get_cached_module_file
2025-11-20 17:21:37,871 - ERROR -       modules_needed = check_imports(resolved_module_file)
2025-11-20 17:21:37,871 - ERROR -     File
2025-11-20 17:21:37,871 - ERROR -   "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py",
2025-11-20 17:21:37,871 - ERROR -   line 260, in check_imports
2025-11-20 17:21:37,871 - ERROR -       raise ImportError(
2025-11-20 17:21:37,871 - ERROR -       ...<2 lines>...
2025-11-20 17:21:37,871 - ERROR -       )
2025-11-20 17:21:37,871 - ERROR -   ImportError: This modeling file requires the following packages that were not
2025-11-20 17:21:37,871 - ERROR -   found in your environment: tensorflow. Run `pip install tensorflow`
2025-11-20 17:21:37,871 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:37,871 - INFO - Processing Model [14/32]: [95mmlx-community/Phi-3.5-vision-instruct-bf16[0m
2025-11-20 17:21:37,871 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:21:37,872 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Phi-3.5-vision-instruct-bf16[0m
2025-11-20 17:21:38,031 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:22:06,178 - DEBUG - Cleaned up resources for model mlx-community/Phi-3.5-vision-instruct-bf16
2025-11-20 17:22:06,179 - INFO - Quality analysis for mlx-community/Phi-3.5-vision-instruct-bf16: no issues detected
2025-11-20 17:22:06,179 - INFO - [92m[RUN 14/32] SUMMARY model=mlx-community/Phi-3.5-vision-instruct-bf16 status=OK[0m
2025-11-20 17:22:06,179 - INFO - [92mtokens=1238 prompt=1042 gen=196 gen_tps=10.9 peak_mem=69GB total_time=28.28s[0m
2025-11-20 17:22:06,179 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/Phi-3.5-vision-instruct-bf16[0m[0m
2025-11-20 17:22:06,179 - INFO - 
2025-11-20 17:22:06,180 - INFO - Generated Text:
2025-11-20 17:22:06,180 - INFO -    Caption: White Rock Seafront in Hastings, England - Late Autumn Evening.
2025-11-20 17:22:06,180 - INFO -    Description: The image depicts a serene evening scene at the White Rock
2025-11-20 17:22:06,180 - INFO -    seafront in Hastings, England. The wet paving stones reflect the dimming
2025-11-20 17:22:06,180 - INFO -    light of the setting sun, with the sky transitioning from day to dusk. The
2025-11-20 17:22:06,180 - INFO -    architecture of the area is characterized by a row of modern hotels and
2025-11-20 17:22:06,180 - INFO -    apartments, indicative of the town's development during the Victorian era. A
2025-11-20 17:22:06,180 - INFO -    car's motion blur is captured in the background, adding a dynamic element to
2025-11-20 17:22:06,180 - INFO -    the otherwise still life. The date and time stamp on the image suggests it
2025-11-20 17:22:06,180 - INFO -    was taken in late November 2025.  Keywords: White Rock, Hastings, England,
2025-11-20 17:22:06,180 - INFO -    Victorian architecture, seafront, evening, dusk, paving stones, reflection,
2025-11-20 17:22:06,180 - INFO -    car motion blur, tranquility, coastal resort.
2025-11-20 17:22:06,180 - INFO - 
2025-11-20 17:22:06,180 - INFO - 
2025-11-20 17:22:06,180 - INFO - 📊 Metrics: total=28.28s  gen=23.36s  load=4.92s  peak_mem=69GB  tokens(total/prompt/gen)=1,238/1,042/196  gen_tps=10.9  prompt_tps=204
2025-11-20 17:22:06,180 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:22:06,180 - INFO - Processing Model [15/32]: [95mmlx-community/Qwen2-VL-2B-Instruct-4bit[0m
2025-11-20 17:22:06,180 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:22:06,180 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Qwen2-VL-2B-Instruct-4bit[0m
2025-11-20 17:22:06,342 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:22:08,237 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4576, in _run_model_generation
    output: GenerationResult | SupportsGenerationResult = generate(
                                                          ~~~~~~~~^
        model=model,
        ^^^^^^^^^^^^
    ...<13 lines>...
        max_tokens=params.max_tokens,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 539, in generate
    for response in stream_generate(model, processor, prompt, image, audio, **kwargs):
                    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 429, in stream_generate
    for n, (token, logprobs) in enumerate(
                                ~~~~~~~~~^
        generate_step(input_ids, model, pixel_values, mask, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 324, in generate_step
    mx.async_eval(y)
    ~~~~~~~~~~~~~^^^
RuntimeError: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4610, in _run_model_generation
    raise ValueError(msg) from gen_err
ValueError: Model runtime error during generation for mlx-community/Qwen2-VL-2B-Instruct-4bit: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4576, in _run_model_generation
    output: GenerationResult | SupportsGenerationResult = generate(
                                                          ~~~~~~~~^
        model=model,
        ^^^^^^^^^^^^
    ...<13 lines>...
        max_tokens=params.max_tokens,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 539, in generate
    for response in stream_generate(model, processor, prompt, image, audio, **kwargs):
                    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 429, in stream_generate
    for n, (token, logprobs) in enumerate(
                                ~~~~~~~~~^
        generate_step(input_ids, model, pixel_values, mask, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 324, in generate_step
    mx.async_eval(y)
    ~~~~~~~~~~~~~^^^
RuntimeError: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.

2025-11-20 17:22:08,286 - DEBUG - Cleaned up resources for model mlx-community/Qwen2-VL-2B-Instruct-4bit
2025-11-20 17:22:08,286 - ERROR - [91m[RUN 15/32] SUMMARY model=mlx-community/Qwen2-VL-2B-Instruct-4bit status=FAIL[0m
2025-11-20 17:22:08,286 - ERROR - [91mstage=OOM error=Model runtime error during generation fo…[0m
2025-11-20 17:22:08,286 - ERROR - [1m[91m✗ FAILED: [91mmlx-community/Qwen2-VL-2B-Instruct-4bit[0m[0m
2025-11-20 17:22:08,286 - ERROR - Stage:
2025-11-20 17:22:08,286 - ERROR -   OOM
2025-11-20 17:22:08,286 - ERROR - Error:
2025-11-20 17:22:08,286 - ERROR -   Model runtime error during generation for
2025-11-20 17:22:08,286 - ERROR -   mlx-community/Qwen2-VL-2B-Instruct-4bit: [metal::malloc] Attempting to
2025-11-20 17:22:08,286 - ERROR -   allocate 135383101952 bytes which is greater than the maximum allowed buffer
2025-11-20 17:22:08,286 - ERROR -   size of 86586540032 bytes.
2025-11-20 17:22:08,286 - ERROR -   Traceback (most recent call last):
2025-11-20 17:22:08,286 - ERROR -     File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4576,
2025-11-20 17:22:08,286 - ERROR -   in _run_model_generation
2025-11-20 17:22:08,286 - ERROR -       output: GenerationResult | SupportsGenerationResult = generate(
2025-11-20 17:22:08,286 - ERROR -                                                             ~~~~~~~~^
2025-11-20 17:22:08,287 - ERROR -           model=model,
2025-11-20 17:22:08,287 - ERROR -           ^^^^^^^^^^^^
2025-11-20 17:22:08,287 - ERROR -       ...<13 lines>...
2025-11-20 17:22:08,287 - ERROR -           max_tokens=params.max_tokens,
2025-11-20 17:22:08,287 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:22:08,287 - ERROR -       )
2025-11-20 17:22:08,287 - ERROR -       ^
2025-11-20 17:22:08,287 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 539, in
2025-11-20 17:22:08,287 - ERROR -   generate
2025-11-20 17:22:08,287 - ERROR -       for response in stream_generate(model, processor, prompt, image, audio,
2025-11-20 17:22:08,287 - ERROR -   **kwargs):
2025-11-20 17:22:08,287 - ERROR -   ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:22:08,287 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 429, in
2025-11-20 17:22:08,287 - ERROR -   stream_generate
2025-11-20 17:22:08,287 - ERROR -       for n, (token, logprobs) in enumerate(
2025-11-20 17:22:08,287 - ERROR -                                   ~~~~~~~~~^
2025-11-20 17:22:08,287 - ERROR -           generate_step(input_ids, model, pixel_values, mask, **kwargs)
2025-11-20 17:22:08,287 - ERROR -           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-20 17:22:08,287 - ERROR -       ):
2025-11-20 17:22:08,287 - ERROR -       ^
2025-11-20 17:22:08,287 - ERROR -     File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 324, in
2025-11-20 17:22:08,287 - ERROR -   generate_step
2025-11-20 17:22:08,287 - ERROR -       mx.async_eval(y)
2025-11-20 17:22:08,287 - ERROR -       ~~~~~~~~~~~~~^^^
2025-11-20 17:22:08,287 - ERROR -   RuntimeError: [metal::malloc] Attempting to allocate 135383101952 bytes which
2025-11-20 17:22:08,287 - ERROR -   is greater than the maximum allowed buffer size of 86586540032 bytes.
2025-11-20 17:22:08,287 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:22:08,287 - INFO - Processing Model [16/32]: [95mmlx-community/Qwen3-VL-2B-Thinking-bf16[0m
2025-11-20 17:22:08,287 - INFO - ────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:22:08,287 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/Qwen3-VL-2B-Thinking-bf16[0m
2025-11-20 17:22:08,450 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:23:13,372 - DEBUG - Cleaned up resources for model mlx-community/Qwen3-VL-2B-Thinking-bf16
2025-11-20 17:23:13,374 - INFO - Quality analysis for mlx-community/Qwen3-VL-2B-Thinking-bf16: verbose=True
2025-11-20 17:23:13,374 - INFO - Quality issues detected for mlx-community/Qwen3-VL-2B-Thinking-bf16: verbose
2025-11-20 17:23:13,374 - INFO - [92m[RUN 16/32] SUMMARY model=mlx-community/Qwen3-VL-2B-Thinking-bf16 status=OK tokens=17005[0m
2025-11-20 17:23:13,374 - INFO - [92mprompt=16505 gen=500 gen_tps=69.2 peak_mem=54GB total_time=65.06s[0m
2025-11-20 17:23:13,374 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/Qwen3-VL-2B-Thinking-bf16[0m[0m
2025-11-20 17:23:13,374 - INFO - 
2025-11-20 17:23:13,375 - INFO - Generated Text:
2025-11-20 17:23:13,375 - WARNING - ⚠️  Note: Output is excessively verbose (500 tokens)
2025-11-20 17:23:13,375 - INFO -    Got it, let's break this down. First, the task is to provide a factual caption, description, and
2025-11-20 17:23:13,375 - INFO -    keywords for the image. The context is White Rock, Hastings, England, UK. The user provided a
2025-11-20 17:23:13,375 - INFO -    caption, but we need to make sure it's factual and specific, based on the image.  First, the
2025-11-20 17:23:13,375 - INFO -    caption. The original caption is given, but we need to check if it's accurate. The image shows a
2025-11-20 17:23:13,375 - INFO -    seafront area with wet pavement, buildings, cars, etc. The caption mentions "damp, late autumn
2025-11-20 17:23:13,375 - INFO -    afternoon" – the sky is overcast, so maybe early evening. The buildings are hotels and
2025-11-20 17:23:13,375 - INFO -    apartments, which matches White Rock. The rain-slicked paving reflects the sky, which is correct.
2025-11-20 17:23:13,375 - INFO -    The motion blur of a car's taillights is there, so that's accurate. The context says it was
2025-11-20 17:23:13,375 - INFO -    developed during Victorian era, which is true for Hastings, but the image is from 2025, which is
2025-11-20 17:23:13,375 - INFO -    future, but the caption says 2025-11-15, so maybe the photo was taken then. Wait, the user says
2025-11-20 17:23:13,375 - INFO -    "Do not speculate. Focus on visual content, drawing on any available contextual information for
2025-11-20 17:23:13,375 - INFO -    specificity."  Wait, the user provided a caption, but we need to create a factual caption based
2025-11-20 17:23:13,375 - INFO -    on the image. Wait, the user says "Here is a caption for the image, written for the specified
2025-11-20 17:23:13,375 - INFO -    audience and context:" but then says "Do not speculate. Focus on visual content, drawing on any
2025-11-20 17:23:13,375 - INFO -    available contextual information for specificity."  Wait, maybe the user wants us to create a
2025-11-20 17:23:13,375 - INFO -    caption that's factual, based on the image, not the provided one. Wait, no, the user says
2025-11-20 17:23:13,375 - INFO -    "Provide a factual caption, description, and keywords suitable for cataloguing, or searching for,
2025-11-20 17:23:13,375 - INFO -    the image." The context is White Rock, Hastings, England, UK.  First, the caption: need to be
2025-11-20 17:23:13,375 - INFO -    factual. Let's look at the image. The scene is a seafront, wet pavement, buildings (white,
2025-11-20 17:23:13,375 - INFO -    multi-story, typical of Hastings), street lamps, cars with taillights blurred, overcast sky,
2025-11-20 17:23:13,375 - INFO -    maybe early evening (dusk). The buildings are hotels and apartments, which is correct for White
2025-11-20 17:23:13,375 - INFO -    Rock. The pavement is wet, reflecting the sky, so it's rainy or recently rained. The time of day
2025-11-20 17:23:13,375 - INFO -    is probably late afternoon or early evening, as dusk is beginning. The cars have motion blur, so
2025-11-20 17:23:13,376 - INFO -    they're moving. The area is
2025-11-20 17:23:13,376 - INFO - 
2025-11-20 17:23:13,376 - INFO - 
2025-11-20 17:23:13,376 - INFO - 📊 Metrics: total=65.06s  gen=63.71s  load=1.35s  peak_mem=54GB  tokens(total/prompt/gen)=17,005/16,505/500  gen_tps=69.2  prompt_tps=294
2025-11-20 17:23:13,376 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:13,376 - INFO - Processing Model [17/32]: [95mmlx-community/SmolVLM-Instruct-bf16[0m
2025-11-20 17:23:13,376 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:13,376 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/SmolVLM-Instruct-bf16[0m
2025-11-20 17:23:13,550 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:23:16,624 - DEBUG - Cleaned up resources for model mlx-community/SmolVLM-Instruct-bf16
2025-11-20 17:23:16,624 - INFO - Quality analysis for mlx-community/SmolVLM-Instruct-bf16: no issues detected
2025-11-20 17:23:16,625 - INFO - [92m[RUN 17/32] SUMMARY model=mlx-community/SmolVLM-Instruct-bf16 status=OK tokens=1439 prompt=1430[0m
2025-11-20 17:23:16,625 - INFO - [92mgen=9 gen_tps=130 peak_mem=47GB total_time=3.24s[0m
2025-11-20 17:23:16,625 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/SmolVLM-Instruct-bf16[0m[0m
2025-11-20 17:23:16,625 - INFO - 
2025-11-20 17:23:16,625 - INFO - Generated Text:
2025-11-20 17:23:16,625 - INFO -    A rainy day in Hastings, England.
2025-11-20 17:23:16,625 - INFO - 
2025-11-20 17:23:16,625 - INFO - 
2025-11-20 17:23:16,625 - INFO - 📊 Metrics: total=3.24s  gen=2.16s  load=1.08s  peak_mem=47GB  tokens(total/prompt/gen)=1,439/1,430/9  gen_tps=130  prompt_tps=885
2025-11-20 17:23:16,625 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:16,625 - INFO - Processing Model [18/32]: [95mmlx-community/SmolVLM2-2.2B-Instruct-mlx[0m
2025-11-20 17:23:16,625 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:16,625 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/SmolVLM2-2.2B-Instruct-mlx[0m
2025-11-20 17:23:16,794 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:23:20,188 - DEBUG - Cleaned up resources for model mlx-community/SmolVLM2-2.2B-Instruct-mlx
2025-11-20 17:23:20,188 - INFO - Quality analysis for mlx-community/SmolVLM2-2.2B-Instruct-mlx: context_ignored=True
2025-11-20 17:23:20,188 - INFO - Quality issues detected for mlx-community/SmolVLM2-2.2B-Instruct-mlx: context-ignored
2025-11-20 17:23:20,188 - INFO - [92m[RUN 18/32] SUMMARY model=mlx-community/SmolVLM2-2.2B-Instruct-mlx status=OK tokens=1359 prompt=1330[0m
2025-11-20 17:23:20,188 - INFO - [92mgen=29 gen_tps=121 peak_mem=47GB total_time=3.55s[0m
2025-11-20 17:23:20,188 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/SmolVLM2-2.2B-Instruct-mlx[0m[0m
2025-11-20 17:23:20,188 - INFO - 
2025-11-20 17:23:20,188 - INFO - Generated Text:
2025-11-20 17:23:20,189 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock)
2025-11-20 17:23:20,189 - INFO -    A wet pavement with three large concrete blocks in the foreground. In the background, there are
2025-11-20 17:23:20,189 - INFO -    white buildings and a street with cars passing by.
2025-11-20 17:23:20,189 - INFO - 
2025-11-20 17:23:20,189 - INFO - 
2025-11-20 17:23:20,189 - INFO - 📊 Metrics: total=3.55s  gen=2.25s  load=1.30s  peak_mem=47GB  tokens(total/prompt/gen)=1,359/1,330/29  gen_tps=121  prompt_tps=865
2025-11-20 17:23:20,189 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:20,189 - INFO - Processing Model [19/32]: [95mmlx-community/deepseek-vl2-8bit[0m
2025-11-20 17:23:20,189 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:20,189 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/deepseek-vl2-8bit[0m
2025-11-20 17:23:20,354 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:23:38,013 - DEBUG - Cleaned up resources for model mlx-community/deepseek-vl2-8bit
2025-11-20 17:23:38,014 - INFO - Quality analysis for mlx-community/deepseek-vl2-8bit: formatting_issues=True
2025-11-20 17:23:38,014 - INFO - Quality issues detected for mlx-community/deepseek-vl2-8bit: formatting
2025-11-20 17:23:38,014 - INFO - [92m[RUN 19/32] SUMMARY model=mlx-community/deepseek-vl2-8bit status=OK tokens=2219 prompt=2041 gen=178[0m
2025-11-20 17:23:38,014 - INFO - [92mgen_tps=63.1 peak_mem=74GB total_time=17.75s[0m
2025-11-20 17:23:38,014 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/deepseek-vl2-8bit[0m[0m
2025-11-20 17:23:38,014 - INFO - 
2025-11-20 17:23:38,014 - INFO - Generated Text:
2025-11-20 17:23:38,014 - WARNING - ⚠️  Note:  Unknown tags: &lt;start of description&gt;
2025-11-20 17:23:38,014 - INFO -    <start of description> The image captures a quiet, overcast day in White Rock, Hastings, UK. The
2025-11-20 17:23:38,014 - INFO -    scene is set in the late afternoon, with the sky overcast and the light suggesting early evening
2025-11-20 17:23:38,014 - INFO -    is approaching. The foreground is dominated by a series of large, light-colored, square planters
2025-11-20 17:23:38,014 - INFO -    with rounded edges, arranged in a line and showing signs of weathering and moss growth. The
2025-11-20 17:23:38,014 - INFO -    ground is a dark, wet tarmac, reflecting the overcast sky and suggesting recent rain. In the
2025-11-20 17:23:38,015 - INFO -    background, there are multi-story buildings with a mix of modern and older architectural styles.
2025-11-20 17:23:38,015 - INFO -    The buildings are mostly white with some pastel colors, and they have multiple stories with a
2025-11-20 17:23:38,015 - INFO -    variety of window styles. The overall atmosphere is calm and somewhat desolate, with no people in
2025-11-20 17:23:38,015 - INFO -    sight. The image is captured in a realistic style with a focus on the textures and colors of the
2025-11-20 17:23:38,015 - INFO -    urban environment.
2025-11-20 17:23:38,015 - INFO - 
2025-11-20 17:23:38,015 - INFO - 
2025-11-20 17:23:38,015 - INFO - 📊 Metrics: total=17.75s  gen=9.96s  load=7.79s  peak_mem=74GB  tokens(total/prompt/gen)=2,219/2,041/178  gen_tps=63.1  prompt_tps=304
2025-11-20 17:23:38,015 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:38,015 - INFO - Processing Model [20/32]: [95mmlx-community/gemma-3-12b-pt-8bit[0m
2025-11-20 17:23:38,015 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:38,015 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/gemma-3-12b-pt-8bit[0m
2025-11-20 17:23:38,185 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:23:41,551 - ERROR - Model processing error
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4648, in process_image_with_model
    output: GenerationResult | SupportsGenerationResult = _run_model_generation(
                                                          ~~~~~~~~~~~~~~~~~~~~~^
        params=params,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4559, in _run_model_generation
    formatted_prompt: str | list[Any] = apply_chat_template(
                                        ~~~~~~~~~~~~~~~~~~~^
        processor=tokenizer,
        ^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        num_images=1,
        ^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/prompt_utils.py", line 496, in apply_chat_template
    return get_chat_template(processor, messages, add_generation_prompt)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/prompt_utils.py", line 381, in get_chat_template
    return processor.apply_chat_template(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        messages,
        ^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1571, in apply_chat_template
    raise ValueError(
        "Cannot use apply_chat_template because this processor does not have a chat template."
    )
ValueError: Cannot use apply_chat_template because this processor does not have a chat template.
2025-11-20 17:23:41,653 - DEBUG - Cleaned up resources for model mlx-community/gemma-3-12b-pt-8bit
2025-11-20 17:23:41,654 - ERROR - [91m[RUN 20/32] SUMMARY model=mlx-community/gemma-3-12b-pt-8bit status=FAIL stage=Error error=Cannot use[0m
2025-11-20 17:23:41,654 - ERROR - [91mapply_chat_template because t…[0m
2025-11-20 17:23:41,654 - ERROR - [1m[91m✗ FAILED: [91mmlx-community/gemma-3-12b-pt-8bit[0m[0m
2025-11-20 17:23:41,654 - ERROR - Stage:
2025-11-20 17:23:41,654 - ERROR -   Error
2025-11-20 17:23:41,654 - ERROR - Error:
2025-11-20 17:23:41,654 - ERROR -   Cannot use apply_chat_template because this processor does not have a chat template.
2025-11-20 17:23:41,654 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:41,654 - INFO - Processing Model [21/32]: [95mmlx-community/gemma-3-27b-it-qat-4bit[0m
2025-11-20 17:23:41,654 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:23:41,654 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/gemma-3-27b-it-qat-4bit[0m
2025-11-20 17:23:41,817 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:24:00,523 - DEBUG - Cleaned up resources for model mlx-community/gemma-3-27b-it-qat-4bit
2025-11-20 17:24:00,524 - INFO - Quality analysis for mlx-community/gemma-3-27b-it-qat-4bit: excessive_bullets=True (count=30)
2025-11-20 17:24:00,524 - INFO - Quality issues detected for mlx-community/gemma-3-27b-it-qat-4bit: bullets(30)
2025-11-20 17:24:00,524 - INFO - [92m[RUN 21/32] SUMMARY model=mlx-community/gemma-3-27b-it-qat-4bit status=OK tokens=808 prompt=504[0m
2025-11-20 17:24:00,524 - INFO - [92mgen=304 gen_tps=26.9 peak_mem=60GB total_time=18.83s[0m
2025-11-20 17:24:00,524 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/gemma-3-27b-it-qat-4bit[0m[0m
2025-11-20 17:24:00,524 - INFO - 
2025-11-20 17:24:00,525 - INFO - Generated Text:
2025-11-20 17:24:00,525 - INFO -    ## Image Catalogue Information:  **Caption:** Wet paving stones and concrete planters along the
2025-11-20 17:24:00,525 - INFO -    seafront promenade at White Rock, Hastings, England, with hotels and apartments visible in the
2025-11-20 17:24:00,525 - INFO -    background. The image was taken on a damp afternoon in November 2025.  **Description:** A
2025-11-20 17:24:00,525 - INFO -    low-angle, medium-shot photograph depicting the wet, tiled pavement of the seafront promenade at
2025-11-20 17:24:00,525 - INFO -    White Rock, Hastings, England. Four concrete planters with moss growth are in the foreground. The
2025-11-20 17:24:00,525 - INFO -    pavement is reflective due to recent rain. In the background, a row of predominantly white and
2025-11-20 17:24:00,525 - INFO -    light-coloured hotels and apartment buildings are visible. Motion blur indicates a vehicle
2025-11-20 17:24:00,525 - INFO -    passing along the road. The sky is overcast. Streetlights are present.  **Keywords:**  *   White
2025-11-20 17:24:00,525 - INFO -    Rock *   Hastings *   England *   United Kingdom *   UK *   Seaside *   Seafront *   Promenade *
2025-11-20 17:24:00,525 - INFO -    November *   Autumn *   Rain *   Wet Pavement *   Concrete Planters *   Hotels *   Apartments *
2025-11-20 17:24:00,525 - INFO -    Streetlights *   Urban Landscape *   Coastal Town *   2025 *   GMT *   Motion Blur *   Overcast
2025-11-20 17:24:00,525 - INFO -    Sky *   Exterior *   Architecture *   Buildings *   Street Furniture *   Reflections *   Low
2025-11-20 17:24:00,525 - INFO -    Angle *   Coastal Architecture *   Victorian Era (contextual - for search relevance)
2025-11-20 17:24:00,525 - INFO - 
2025-11-20 17:24:00,525 - INFO - 
2025-11-20 17:24:00,525 - INFO - 📊 Metrics: total=18.83s  gen=14.88s  load=3.95s  peak_mem=60GB  tokens(total/prompt/gen)=808/504/304  gen_tps=26.9  prompt_tps=154
2025-11-20 17:24:00,525 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:24:00,525 - INFO - Processing Model [22/32]: [95mmlx-community/gemma-3-27b-it-qat-8bit[0m
2025-11-20 17:24:00,525 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:24:00,525 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/gemma-3-27b-it-qat-8bit[0m
2025-11-20 17:24:00,696 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:24:50,172 - DEBUG - Cleaned up resources for model mlx-community/gemma-3-27b-it-qat-8bit
2025-11-20 17:24:50,173 - INFO - Quality analysis for mlx-community/gemma-3-27b-it-qat-8bit: verbose=True, excessive_bullets=True (count=66)
2025-11-20 17:24:50,173 - INFO - Quality issues detected for mlx-community/gemma-3-27b-it-qat-8bit: verbose, bullets(66)
2025-11-20 17:24:50,173 - INFO - [92m[RUN 22/32] SUMMARY model=mlx-community/gemma-3-27b-it-qat-8bit status=OK tokens=1004 prompt=504[0m
2025-11-20 17:24:50,173 - INFO - [92mgen=500 gen_tps=14.5 peak_mem=42GB total_time=49.58s[0m
2025-11-20 17:24:50,173 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/gemma-3-27b-it-qat-8bit[0m[0m
2025-11-20 17:24:50,173 - INFO - 
2025-11-20 17:24:50,174 - INFO - Generated Text:
2025-11-20 17:24:50,174 - WARNING - ⚠️  Note: Output is excessively verbose (500 tokens)
2025-11-20 17:24:50,174 - INFO -    ## Caption:  Rain-slicked paving stones and concrete planters along the seafront promenade at
2025-11-20 17:24:50,174 - INFO -    White Rock, Hastings, England, on a late autumn afternoon, November 15, 2025. Hotels and
2025-11-20 17:24:50,174 - INFO -    apartments line the background of the scene.  ## Description:  A low-angle, medium shot depicts a
2025-11-20 17:24:50,174 - INFO -    wet, paved area at White Rock, Hastings. The foreground features a series of square, concrete
2025-11-20 17:24:50,174 - INFO -    planters, some showing signs of moss growth, reflecting the overcast sky. The paving stones are
2025-11-20 17:24:50,174 - INFO -    dark and glossy from recent rain. Motion blur from a passing vehicle’s taillights is visible in
2025-11-20 17:24:50,174 - INFO -    the mid-ground. Behind the planters, a row of white and pastel-coloured hotels and apartments
2025-11-20 17:24:50,174 - INFO -    extends along the road, typical of Victorian-era seaside architecture. Streetlights are visible
2025-11-20 17:24:50,174 - INFO -    along the road. The overall atmosphere is quiet and subdued, with a cool colour palette.  ##
2025-11-20 17:24:50,174 - INFO -    Keywords:  *   White Rock *   Hastings *   England *   UK *   United Kingdom *   East Sussex *
2025-11-20 17:24:50,174 - INFO -    Seaside *   Seafront *   Promenade *   Victorian Architecture *   Hotels *   Apartments *   Rain
2025-11-20 17:24:50,175 - INFO -    *   Wet Pavement *   Concrete Planters *   Autumn *   November *   2025 *   Street Photography *
2025-11-20 17:24:50,175 - INFO -    Urban Landscape *   Coastal Town *   Motion Blur *   Overcast *   Dusk *   Streetlights *
2025-11-20 17:24:50,175 - INFO -    Paving Stones *   Coastal Architecture *   British Seaside Resort *   Exterior *   Buildings *
2025-11-20 17:24:50,175 - INFO -    Townscape *   Architecture *   Travel *   Landscape *   Exterior View *   Wet Weather *   Urban
2025-11-20 17:24:50,175 - INFO -    Scene *   Concrete *   Planters *   Moss *   Road *   Vehicle *   Taillights *   Street Furniture
2025-11-20 17:24:50,175 - INFO -    *   Exterior Lighting *   Low Angle *   Medium Shot *   Exterior *   Exterior View *   Exterior
2025-11-20 17:24:50,175 - INFO -    Lighting *   Exterior *   Exterior View *   Exterior Lighting *   Exterior *   Exterior View *
2025-11-20 17:24:50,175 - INFO -    Exterior Lighting *   Exterior *   Exterior View *   Exterior Lighting *   Exterior *   Exterior
2025-11-20 17:24:50,175 - INFO -    View *   Exterior Lighting *   Exterior *   Exterior View *   Exterior Lighting *   Exterior
2025-11-20 17:24:50,175 - INFO - 
2025-11-20 17:24:50,175 - INFO - 
2025-11-20 17:24:50,175 - INFO - 📊 Metrics: total=49.58s  gen=41.36s  load=8.22s  peak_mem=42GB  tokens(total/prompt/gen)=1,004/504/500  gen_tps=14.5  prompt_tps=77.2
2025-11-20 17:24:50,175 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:24:50,175 - INFO - Processing Model [23/32]: [95mmlx-community/gemma-3n-E4B-it-bf16[0m
2025-11-20 17:24:50,175 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:24:50,175 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/gemma-3n-E4B-it-bf16[0m
2025-11-20 17:24:50,339 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:24:59,198 - DEBUG - Cleaned up resources for model mlx-community/gemma-3n-E4B-it-bf16
2025-11-20 17:24:59,198 - INFO - Quality analysis for mlx-community/gemma-3n-E4B-it-bf16: no issues detected
2025-11-20 17:24:59,198 - INFO - [92m[RUN 23/32] SUMMARY model=mlx-community/gemma-3n-E4B-it-bf16 status=OK tokens=676 prompt=504 gen=172[0m
2025-11-20 17:24:59,198 - INFO - [92mgen_tps=42.2 peak_mem=18GB total_time=8.99s[0m
2025-11-20 17:24:59,198 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/gemma-3n-E4B-it-bf16[0m[0m
2025-11-20 17:24:59,198 - INFO - 
2025-11-20 17:24:59,199 - INFO - Generated Text:
2025-11-20 17:24:59,199 - INFO -    ## Caption:  Rain-slicked pavement reflects the soft glow of streetlights and distant car
2025-11-20 17:24:59,199 - INFO -    headlights along the promenade at White Rock, Hastings, UK, as dusk settles over the British
2025-11-20 17:24:59,199 - INFO -    seaside town.  ## Context:  This image captures a typical evening scene on White Rock, a
2025-11-20 17:24:59,199 - INFO -    prominent promenade in Hastings, England. The wet pavement reflects the ambient light, creating a
2025-11-20 17:24:59,199 - INFO -    moody and atmospheric feel. The architecture in the background is characteristic of Victorian-era
2025-11-20 17:24:59,199 - INFO -    seaside resorts, showcasing the historical development of Hastings as a popular coastal
2025-11-20 17:24:59,199 - INFO -    destination. The presence of parked cars and streetlights further emphasizes the urban yet
2025-11-20 17:24:59,199 - INFO -    relaxed atmosphere of the town.  ## Keywords:  White Rock, Hastings, England, UK, promenade,
2025-11-20 17:24:59,199 - INFO -    seaside, dusk, rain, reflection, streetlights, cars, Victorian architecture, coastal town, urban,
2025-11-20 17:24:59,199 - INFO -    evening, pavement, wet, atmospheric, British.
2025-11-20 17:24:59,199 - INFO - 
2025-11-20 17:24:59,199 - INFO - 
2025-11-20 17:24:59,199 - INFO - 📊 Metrics: total=8.99s  gen=5.05s  load=3.94s  peak_mem=18GB  tokens(total/prompt/gen)=676/504/172  gen_tps=42.2  prompt_tps=716
2025-11-20 17:24:59,199 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:24:59,199 - INFO - Processing Model [24/32]: [95mmlx-community/llava-v1.6-mistral-7b-8bit[0m
2025-11-20 17:24:59,199 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:24:59,199 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/llava-v1.6-mistral-7b-8bit[0m
2025-11-20 17:24:59,363 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:25:12,050 - DEBUG - Cleaned up resources for model mlx-community/llava-v1.6-mistral-7b-8bit
2025-11-20 17:25:12,051 - INFO - Quality analysis for mlx-community/llava-v1.6-mistral-7b-8bit: context_ignored=True
2025-11-20 17:25:12,051 - INFO - Quality issues detected for mlx-community/llava-v1.6-mistral-7b-8bit: context-ignored
2025-11-20 17:25:12,051 - INFO - [92m[RUN 24/32] SUMMARY model=mlx-community/llava-v1.6-mistral-7b-8bit status=OK tokens=2329 prompt=2321[0m
2025-11-20 17:25:12,051 - INFO - [92mgen=8 gen_tps=47.5 peak_mem=12GB total_time=12.83s[0m
2025-11-20 17:25:12,051 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/llava-v1.6-mistral-7b-8bit[0m[0m
2025-11-20 17:25:12,051 - INFO - 
2025-11-20 17:25:12,051 - INFO - Generated Text:
2025-11-20 17:25:12,051 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock, Here)
2025-11-20 17:25:12,051 - INFO -    The image is a photograph.
2025-11-20 17:25:12,051 - INFO - 
2025-11-20 17:25:12,051 - INFO - 
2025-11-20 17:25:12,051 - INFO - 📊 Metrics: total=12.83s  gen=11.18s  load=1.65s  peak_mem=12GB  tokens(total/prompt/gen)=2,329/2,321/8  gen_tps=47.5  prompt_tps=220
2025-11-20 17:25:12,051 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:25:12,051 - INFO - Processing Model [25/32]: [95mmlx-community/paligemma2-10b-ft-docci-448-6bit[0m
2025-11-20 17:25:12,051 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:25:12,051 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/paligemma2-10b-ft-docci-448-6bit[0m
2025-11-20 17:25:12,216 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:25:21,267 - DEBUG - Cleaned up resources for model mlx-community/paligemma2-10b-ft-docci-448-6bit
2025-11-20 17:25:21,268 - INFO - Quality analysis for mlx-community/paligemma2-10b-ft-docci-448-6bit: context_ignored=True
2025-11-20 17:25:21,268 - INFO - Quality issues detected for mlx-community/paligemma2-10b-ft-docci-448-6bit: context-ignored
2025-11-20 17:25:21,268 - INFO - [92m[RUN 25/32] SUMMARY model=mlx-community/paligemma2-10b-ft-docci-448-6bit status=OK tokens=1416[0m
2025-11-20 17:25:21,268 - INFO - [92mprompt=1262 gen=154 gen_tps=41.4 peak_mem=11GB total_time=9.19s[0m
2025-11-20 17:25:21,268 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/paligemma2-10b-ft-docci-448-6bit[0m[0m
2025-11-20 17:25:21,268 - INFO - 
2025-11-20 17:25:21,268 - INFO - Generated Text:
2025-11-20 17:25:21,268 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock)
2025-11-20 17:25:21,268 - INFO -    The image is a medium-close-up view of three white concrete pillars that are sitting on a black
2025-11-20 17:25:21,268 - INFO -    tile floor. The pillars are rectangular, and the sides of them are covered in green algae. The
2025-11-20 17:25:21,268 - INFO -    pillar on the left is sitting on the floor, and the top of it is covered in water. The pillar in
2025-11-20 17:25:21,268 - INFO -    the middle is sitting on the floor, and the top of it is covered in water. The pillar on the
2025-11-20 17:25:21,268 - INFO -    right is sitting on the floor, and the top of it is covered in water. The pillars are casting a
2025-11-20 17:25:21,268 - INFO -    shadow on the floor. The floor is wet, and there are puddles on it. There is a building in the
2025-11-20 17:25:21,268 - INFO -    background that is white, and there are cars parked in front of it. The sky is covered in clouds.
2025-11-20 17:25:21,268 - INFO - 
2025-11-20 17:25:21,268 - INFO - 
2025-11-20 17:25:21,268 - INFO - 📊 Metrics: total=9.19s  gen=6.62s  load=2.57s  peak_mem=11GB  tokens(total/prompt/gen)=1,416/1,262/154  gen_tps=41.4  prompt_tps=495
2025-11-20 17:25:21,268 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:25:21,268 - INFO - Processing Model [26/32]: [95mmlx-community/paligemma2-10b-ft-docci-448-bf16[0m
2025-11-20 17:25:21,268 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:25:21,268 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/paligemma2-10b-ft-docci-448-bf16[0m
2025-11-20 17:25:21,434 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:27:12,222 - DEBUG - Cleaned up resources for model mlx-community/paligemma2-10b-ft-docci-448-bf16
2025-11-20 17:27:12,224 - INFO - Quality analysis for mlx-community/paligemma2-10b-ft-docci-448-bf16: repetitive=True (token=phrase: "the scene is very..."), context_ignored=True
2025-11-20 17:27:12,224 - INFO - Quality issues detected for mlx-community/paligemma2-10b-ft-docci-448-bf16: repetitive(phrase: "the scene is very..."), context-ignored
2025-11-20 17:27:12,224 - INFO - [92m[RUN 26/32] SUMMARY model=mlx-community/paligemma2-10b-ft-docci-448-bf16 status=OK tokens=1762[0m
2025-11-20 17:27:12,224 - INFO - [92mprompt=1262 gen=500 gen_tps=4.82 peak_mem=27GB total_time=110.91s[0m
2025-11-20 17:27:12,224 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/paligemma2-10b-ft-docci-448-bf16[0m[0m
2025-11-20 17:27:12,224 - INFO - 
2025-11-20 17:27:12,224 - INFO - Generated Text:
2025-11-20 17:27:12,224 - WARNING - ⚠️  WARNING: Output appears to be garbage (repetitive: 'phrase: "the scene is very..."')
2025-11-20 17:27:12,224 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock, Here)
2025-11-20 17:27:12,225 - INFO -    The image is in the daytime, with a low light level. The scene is overcast, with a light blue sky
2025-11-20 17:27:12,225 - INFO -    visible through the clouds. The scene is very visible, with no bright sunlight breaking through.
2025-11-20 17:27:12,225 - INFO -    The scene is very visible, with no bright sunlight breaking through. The scene is very visible,
2025-11-20 17:27:12,225 - INFO -    with no bright sunlight breaking through. The scene is very visible, with no bright sunlight
2025-11-20 17:27:12,225 - INFO -    breaking through. The scene is very visible, with no bright sunlight breaking through. The scene
2025-11-20 17:27:12,225 - INFO -    is very visible, with no bright sunlight breaking through. The scene is very visible, with no
2025-11-20 17:27:12,225 - INFO -    bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking
2025-11-20 17:27:12,225 - INFO -    through. The scene is very visible, with no bright sunlight breaking through. The scene is very
2025-11-20 17:27:12,225 - INFO -    visible, with no bright sunlight breaking through. The scene is very visible, with no bright
2025-11-20 17:27:12,225 - INFO -    sunlight breaking through. The scene is very visible, with no bright sunlight breaking through.
2025-11-20 17:27:12,225 - INFO -    The scene is very visible, with no bright sunlight breaking through. The scene is very visible,
2025-11-20 17:27:12,225 - INFO -    with no bright sunlight breaking through. The scene is very visible, with no bright sunlight
2025-11-20 17:27:12,225 - INFO -    breaking through. The scene is very visible, with no bright sunlight breaking through. The scene
2025-11-20 17:27:12,225 - INFO -    is very visible, with no bright sunlight breaking through. The scene is very visible, with no
2025-11-20 17:27:12,225 - INFO -    bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking
2025-11-20 17:27:12,225 - INFO -    through. The scene is very visible, with no bright sunlight breaking through. The scene is very
2025-11-20 17:27:12,225 - INFO -    visible, with no bright sunlight breaking through. The scene is very visible, with no bright
2025-11-20 17:27:12,225 - INFO -    sunlight breaking through. The scene is very visible, with no bright sunlight breaking through.
2025-11-20 17:27:12,225 - INFO -    The scene is very visible, with no bright sunlight breaking through. The scene is very visible,
2025-11-20 17:27:12,225 - INFO -    with no bright sunlight breaking through. The scene is very visible, with no bright sunlight
2025-11-20 17:27:12,225 - INFO -    breaking through. The scene is very visible, with no bright sunlight breaking through. The scene
2025-11-20 17:27:12,225 - INFO -    is very visible, with no bright sunlight breaking through. The scene is very visible, with no
2025-11-20 17:27:12,225 - INFO -    bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking
2025-11-20 17:27:12,225 - INFO -    through. The scene is very visible, with no bright sunlight breaking through. The scene is very
2025-11-20 17:27:12,225 - INFO -    visible, with no bright sunlight breaking through. The scene is very visible, with no bright
2025-11-20 17:27:12,225 - INFO -    sunlight breaking through. The scene is very visible, with no bright sunlight breaking through.
2025-11-20 17:27:12,225 - INFO -    The scene is very visible, with no bright sunlight breaking through. The scene is very visible,
2025-11-20 17:27:12,225 - INFO -    with no bright sunlight breaking through. The scene is very
2025-11-20 17:27:12,225 - INFO - 
2025-11-20 17:27:12,225 - INFO - 
2025-11-20 17:27:12,225 - INFO - 📊 Metrics: total=110.91s  gen=106.72s  load=4.20s  peak_mem=27GB  tokens(total/prompt/gen)=1,762/1,262/500  gen_tps=4.82  prompt_tps=474
2025-11-20 17:27:12,225 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:12,225 - INFO - Processing Model [27/32]: [95mmlx-community/paligemma2-3b-ft-docci-448-bf16[0m
2025-11-20 17:27:12,225 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:12,225 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/paligemma2-3b-ft-docci-448-bf16[0m
2025-11-20 17:27:12,394 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:27:28,797 - DEBUG - Cleaned up resources for model mlx-community/paligemma2-3b-ft-docci-448-bf16
2025-11-20 17:27:28,797 - INFO - Quality analysis for mlx-community/paligemma2-3b-ft-docci-448-bf16: context_ignored=True
2025-11-20 17:27:28,797 - INFO - Quality issues detected for mlx-community/paligemma2-3b-ft-docci-448-bf16: context-ignored
2025-11-20 17:27:28,797 - INFO - [92m[RUN 27/32] SUMMARY model=mlx-community/paligemma2-3b-ft-docci-448-bf16 status=OK tokens=1482[0m
2025-11-20 17:27:28,797 - INFO - [92mprompt=1262 gen=220 gen_tps=16.8 peak_mem=11GB total_time=16.56s[0m
2025-11-20 17:27:28,797 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/paligemma2-3b-ft-docci-448-bf16[0m[0m
2025-11-20 17:27:28,797 - INFO - 
2025-11-20 17:27:28,798 - INFO - Generated Text:
2025-11-20 17:27:28,798 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock, Here)
2025-11-20 17:27:28,798 - INFO -    The image is in a low resolution, with the background intentionally blurred. The foreground is in
2025-11-20 17:27:28,798 - INFO -    focus, with the concrete seating visible in the lower half of the frame. The seating is a simple,
2025-11-20 17:27:28,798 - INFO -    rounded, concrete block with a square base. The top of the blocks are rounded, with a small gap
2025-11-20 17:27:28,798 - INFO -    between each block. The top of the blocks have a layer of green algae growing on the upper edge.
2025-11-20 17:27:28,798 - INFO -    The concrete blocks are wet, with the water visible on the lower half of the frame. The concrete
2025-11-20 17:27:28,798 - INFO -    blocks are placed on a square, dark gray, concrete tile floor. The tiles are wet, with the water
2025-11-20 17:27:28,798 - INFO -    visible on the lower half of the frame. The background is a row of white, painted, wood-paneled
2025-11-20 17:27:28,798 - INFO -    apartment buildings. The buildings are in a low-angle view, with the top of the buildings in the
2025-11-20 17:27:28,798 - INFO -    upper half of the frame. The buildings are painted white with black accents on the bottom of the
2025-11-20 17:27:28,798 - INFO -    windows. The sky is a soft blue with a hint of gray. The scene is very well lit, with the upper
2025-11-20 17:27:28,798 - INFO -    half of the frame in a soft shadow.
2025-11-20 17:27:28,798 - INFO - 
2025-11-20 17:27:28,798 - INFO - 
2025-11-20 17:27:28,798 - INFO - 📊 Metrics: total=16.56s  gen=14.27s  load=2.28s  peak_mem=11GB  tokens(total/prompt/gen)=1,482/1,262/220  gen_tps=16.8  prompt_tps=1,453
2025-11-20 17:27:28,798 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:28,798 - INFO - Processing Model [28/32]: [95mmlx-community/paligemma2-3b-pt-896-4bit[0m
2025-11-20 17:27:28,798 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:28,798 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/paligemma2-3b-pt-896-4bit[0m
2025-11-20 17:27:28,962 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:27:35,271 - DEBUG - Cleaned up resources for model mlx-community/paligemma2-3b-pt-896-4bit
2025-11-20 17:27:35,271 - INFO - Quality analysis for mlx-community/paligemma2-3b-pt-896-4bit: context_ignored=True
2025-11-20 17:27:35,271 - INFO - Quality issues detected for mlx-community/paligemma2-3b-pt-896-4bit: context-ignored
2025-11-20 17:27:35,271 - INFO - [92m[RUN 28/32] SUMMARY model=mlx-community/paligemma2-3b-pt-896-4bit status=OK tokens=4356 prompt=4334[0m
2025-11-20 17:27:35,271 - INFO - [92mgen=22 gen_tps=102 peak_mem=8.8GB total_time=6.45s[0m
2025-11-20 17:27:35,271 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/paligemma2-3b-pt-896-4bit[0m[0m
2025-11-20 17:27:35,271 - INFO - 
2025-11-20 17:27:35,271 - INFO - Generated Text:
2025-11-20 17:27:35,271 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock, Here)
2025-11-20 17:27:35,271 - INFO -    Provide a factual caption, description, and keywords suitable for cataloguing, or searching for,
2025-11-20 17:27:35,271 - INFO -    the image.
2025-11-20 17:27:35,271 - INFO - 
2025-11-20 17:27:35,271 - INFO - 
2025-11-20 17:27:35,271 - INFO - 📊 Metrics: total=6.45s  gen=4.78s  load=1.67s  peak_mem=8.8GB  tokens(total/prompt/gen)=4,356/4,334/22  gen_tps=102  prompt_tps=1,031
2025-11-20 17:27:35,271 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:35,271 - INFO - Processing Model [29/32]: [95mmlx-community/pixtral-12b-8bit[0m
2025-11-20 17:27:35,271 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:35,272 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/pixtral-12b-8bit[0m
2025-11-20 17:27:35,436 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:27:55,049 - DEBUG - Cleaned up resources for model mlx-community/pixtral-12b-8bit
2025-11-20 17:27:55,051 - INFO - Quality analysis for mlx-community/pixtral-12b-8bit: verbose=True, excessive_bullets=True (count=20)
2025-11-20 17:27:55,051 - INFO - Quality issues detected for mlx-community/pixtral-12b-8bit: verbose, bullets(20)
2025-11-20 17:27:55,051 - INFO - [92m[RUN 29/32] SUMMARY model=mlx-community/pixtral-12b-8bit status=OK tokens=3155 prompt=2842 gen=313[0m
2025-11-20 17:27:55,051 - INFO - [92mgen_tps=30.6 peak_mem=15GB total_time=19.75s[0m
2025-11-20 17:27:55,051 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/pixtral-12b-8bit[0m[0m
2025-11-20 17:27:55,051 - INFO - 
2025-11-20 17:27:55,051 - INFO - Generated Text:
2025-11-20 17:27:55,051 - WARNING - ⚠️  Note: Output is excessively verbose (313 tokens)
2025-11-20 17:27:55,051 - INFO -    ### Caption A damp, late autumn afternoon along the seafront at White Rock in Hastings, England.
2025-11-20 17:27:55,051 - INFO -    The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool,
2025-11-20 17:27:55,051 - INFO -    overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical
2025-11-20 17:27:55,051 - INFO -    of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a
2025-11-20 17:27:55,051 - INFO -    streak of colour and a sense of movement to the otherwise quiet, atmospheric scene.  ###
2025-11-20 17:27:55,051 - INFO -    Description The image captures a tranquil moment on a wet, autumn afternoon at White Rock in
2025-11-20 17:27:55,051 - INFO -    Hastings, England. The foreground features rain-soaked paving stones that mirror the grey,
2025-11-20 17:27:55,052 - INFO -    overcast sky. Three large concrete planters, showing signs of weathering, are positioned
2025-11-20 17:27:55,052 - INFO -    prominently in the foreground. Behind these planters, a row of white buildings with balconies and
2025-11-20 17:27:55,052 - INFO -    bay windows lines the street, characteristic of Victorian-era architecture. The streetlights and
2025-11-20 17:27:55,052 - INFO -    the faint glow from the buildings add a soft illumination to the scene. A passing car's
2025-11-20 17:27:55,052 - INFO -    taillights create a dynamic contrast with the otherwise still and serene environment.  ###
2025-11-20 17:27:55,052 - INFO -    Keywords - White Rock - Hastings - England - United Kingdom - Seafront - Autumn - Rain -
2025-11-20 17:27:55,052 - INFO -    Victorian architecture - Hotels - Apartments - Concrete planters - Weathering - Taillights - Dusk
2025-11-20 17:27:55,052 - INFO -    - Overcast sky - Paving stones - Streetlights - Tranquil - Atmospheric - British seaside town
2025-11-20 17:27:55,052 - INFO - 
2025-11-20 17:27:55,052 - INFO - 
2025-11-20 17:27:55,052 - INFO - 📊 Metrics: total=19.75s  gen=16.98s  load=2.77s  peak_mem=15GB  tokens(total/prompt/gen)=3,155/2,842/313  gen_tps=30.6  prompt_tps=445
2025-11-20 17:27:55,052 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:55,052 - INFO - Processing Model [30/32]: [95mmlx-community/pixtral-12b-bf16[0m
2025-11-20 17:27:55,052 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:27:55,052 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mmlx-community/pixtral-12b-bf16[0m
2025-11-20 17:27:55,219 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:28:22,326 - DEBUG - Cleaned up resources for model mlx-community/pixtral-12b-bf16
2025-11-20 17:28:22,327 - INFO - Quality analysis for mlx-community/pixtral-12b-bf16: excessive_bullets=True (count=17)
2025-11-20 17:28:22,328 - INFO - Quality issues detected for mlx-community/pixtral-12b-bf16: bullets(17)
2025-11-20 17:28:22,328 - INFO - [92m[RUN 30/32] SUMMARY model=mlx-community/pixtral-12b-bf16 status=OK tokens=3139 prompt=2842 gen=297[0m
2025-11-20 17:28:22,328 - INFO - [92mgen_tps=17.6 peak_mem=27GB total_time=27.23s[0m
2025-11-20 17:28:22,328 - INFO - [1m[92m✓ SUCCESS: [95mmlx-community/pixtral-12b-bf16[0m[0m
2025-11-20 17:28:22,328 - INFO - 
2025-11-20 17:28:22,328 - INFO - Generated Text:
2025-11-20 17:28:22,328 - INFO -    ### Caption A damp, late autumn afternoon along the seafront at White Rock in Hastings, England.
2025-11-20 17:28:22,328 - INFO -    The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool,
2025-11-20 17:28:22,328 - INFO -    overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical
2025-11-20 17:28:22,328 - INFO -    of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a
2025-11-20 17:28:22,328 - INFO -    streak of colour and a sense of movement to the otherwise quiet, atmospheric scene.  ###
2025-11-20 17:28:22,328 - INFO -    Description The image captures a tranquil moment on a rainy autumn afternoon at White Rock in
2025-11-20 17:28:22,328 - INFO -    Hastings, England. The wet pavement glistens under the overcast sky, creating a reflective
2025-11-20 17:28:22,328 - INFO -    surface that enhances the serene ambiance. Concrete barriers line the foreground, adding a sense
2025-11-20 17:28:22,328 - INFO -    of depth and perspective. In the background, a row of white buildings, likely hotels or
2025-11-20 17:28:22,328 - INFO -    apartments, stretches along the road, characteristic of a Victorian-era seaside town. The blurred
2025-11-20 17:28:22,328 - INFO -    taillights of a passing car introduce a dynamic element to the otherwise still scene, hinting at
2025-11-20 17:28:22,328 - INFO -    life and movement within the quiet setting.  ### Keywords - White Rock - Hastings - England -
2025-11-20 17:28:22,328 - INFO -    United Kingdom - Seafront - Autumn - Rain - Reflective pavement - Victorian-era buildings -
2025-11-20 17:28:22,328 - INFO -    Hotels - Apartments - Taillights - Dusk - Atmospheric scene - Concrete barriers - Overcast sky -
2025-11-20 17:28:22,328 - INFO -    British seaside town
2025-11-20 17:28:22,328 - INFO - 
2025-11-20 17:28:22,328 - INFO - 
2025-11-20 17:28:22,328 - INFO - 📊 Metrics: total=27.23s  gen=22.76s  load=4.47s  peak_mem=27GB  tokens(total/prompt/gen)=3,139/2,842/297  gen_tps=17.6  prompt_tps=518
2025-11-20 17:28:22,329 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:22,329 - INFO - Processing Model [31/32]: [95mprince-canuma/Florence-2-large-ft[0m
2025-11-20 17:28:22,329 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:22,329 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mprince-canuma/Florence-2-large-ft[0m
2025-11-20 17:28:22,495 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:28:25,618 - DEBUG - Cleaned up resources for model prince-canuma/Florence-2-large-ft
2025-11-20 17:28:25,619 - INFO - Quality analysis for prince-canuma/Florence-2-large-ft: language_mixing=True, formatting_issues=True, context_ignored=True
2025-11-20 17:28:25,619 - INFO - Quality issues detected for prince-canuma/Florence-2-large-ft: lang_mixing, formatting, context-ignored
2025-11-20 17:28:25,619 - INFO - [92m[RUN 31/32] SUMMARY model=prince-canuma/Florence-2-large-ft status=OK tokens=733 prompt=233 gen=500[0m
2025-11-20 17:28:25,619 - INFO - [92mgen_tps=327 peak_mem=5.1GB total_time=3.28s[0m
2025-11-20 17:28:25,619 - INFO - [1m[92m✓ SUCCESS: [95mprince-canuma/Florence-2-large-ft[0m[0m
2025-11-20 17:28:25,619 - INFO - 
2025-11-20 17:28:25,619 - INFO - Generated Text:
2025-11-20 17:28:25,619 - WARNING - ⚠️  Note:  Unknown tags: &lt;s&gt;
2025-11-20 17:28:25,619 - WARNING - ⚠️  Note: Output ignored key context (missing: Hastings, England, United Kingdom, White Rock, Here)
2025-11-20 17:28:25,619 - INFO -    <s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s>
2025-11-20 17:28:25,619 - INFO - 
2025-11-20 17:28:25,619 - INFO - 
2025-11-20 17:28:25,619 - INFO - 📊 Metrics: total=3.28s  gen=2.14s  load=1.15s  peak_mem=5.1GB  tokens(total/prompt/gen)=733/233/500  gen_tps=327  prompt_tps=942
2025-11-20 17:28:25,619 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:25,619 - INFO - Processing Model [32/32]: [95mqnguyen3/nanoLLaVA[0m
2025-11-20 17:28:25,619 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:25,619 - INFO - Processing '[95m20251115-161928_DSC07372.jpg[0m' with model: [95mqnguyen3/nanoLLaVA[0m
2025-11-20 17:28:25,784 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-20 17:28:27,921 - DEBUG - Cleaned up resources for model qnguyen3/nanoLLaVA
2025-11-20 17:28:27,921 - INFO - Quality analysis for qnguyen3/nanoLLaVA: no issues detected
2025-11-20 17:28:27,922 - INFO - [92m[RUN 32/32] SUMMARY model=qnguyen3/nanoLLaVA status=OK tokens=340 prompt=249 gen=91 gen_tps=103[0m
2025-11-20 17:28:27,922 - INFO - [92mpeak_mem=4.5GB total_time=2.29s[0m
2025-11-20 17:28:27,922 - INFO - [1m[92m✓ SUCCESS: [95mqnguyen3/nanoLLaVA[0m[0m
2025-11-20 17:28:27,922 - INFO - 
2025-11-20 17:28:27,922 - INFO - Generated Text:
2025-11-20 17:28:27,922 - INFO -    The image captures a rainy day in White Rock, Hastings, England, with a view of the seafront. The
2025-11-20 17:28:27,922 - INFO -    street is wet, and the sky is overcast, suggesting it's either early morning or late afternoon.
2025-11-20 17:28:27,922 - INFO -    The street is lined with hotels and apartments, and the road is wet, reflecting the rain. The
2025-11-20 17:28:27,922 - INFO -    image was taken on 2025-11-15 16:19:28 GMT.
2025-11-20 17:28:27,922 - INFO - 
2025-11-20 17:28:27,922 - INFO - 
2025-11-20 17:28:27,922 - INFO - 📊 Metrics: total=2.29s  gen=1.45s  load=0.84s  peak_mem=4.5GB  tokens(total/prompt/gen)=340/249/91  gen_tps=103  prompt_tps=1,194
2025-11-20 17:28:27,922 - INFO - Performance Summary
2025-11-20 17:28:27,922 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:27,931 - INFO - Model Name                                       | Token (ct) | Prompt (ct) | Gen (ct) | Total Tokens | Prompt (t/s) | Gen (t/s) | Peak (GB) | Generation (s) | Load (s) | Total (s) | Quality Issues                                              | Output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
2025-11-20 17:28:27,931 - INFO - ------------------------------------------------ | ---------- | ----------- | -------- | ------------ | ------------ | --------- | --------- | -------------- | -------- | --------- | ----------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-11-20 17:28:27,931 - INFO - [91mmicrosoft/Florence-2-large-ft                   [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: Model Error - Model loading failed: Missing 1 parameters: 
language_model.lm_head.weight.
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 296, in load
    model = load_model(model_path, lazy, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 225, in load_model
    model.load_weights(list(weights.items()))
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/mlx/nn/layers/base.py", line 191, in load_weights
    raise ValueError(f"Missing {num_missing} parameters: \n{missing}.")
ValueError: Missing 1 parameters: 
language_model.lm_head.weight.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [0m
2025-11-20 17:28:27,931 - INFO - [91mmlx-community/Kimi-VL-A3B-Thinking-2506-bf16    [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: Lib Version - Model loading failed: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/a04b2b044b1795d3e56eeee0d4946ca0c3a9d0fc/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [0m
2025-11-20 17:28:27,931 - INFO - [91mmlx-community/Kimi-VL-A3B-Thinking-8bit         [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: Lib Version - Model loading failed: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 387, in from_pretrained
    processor_class = get_class_from_dynamic_module(
        processor_auto_map, pretrained_model_name_or_path, **kwargs
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 616, in get_class_from_dynamic_module
    return get_class_in_module(class_name, final_module, force_reload=force_download)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 311, in get_class_in_module
    module_spec.loader.exec_module(module)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 1027, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/jrp/.cache/huggingface/modules/transformers_modules/b5f89e575e95a48394b3d708beff29b842a4e14c/processing_kimi_vl.py", line 25, in <module>
    from transformers.processing_utils import ProcessingKwargs, ProcessorMixin, Unpack, _validate_images_text_input_order
ImportError: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [0m
2025-11-20 17:28:27,932 - INFO - [91mmlx-community/Molmo-7B-D-0924-8bit              [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: Missing Dep - Model loading failed: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
[0m
2025-11-20 17:28:27,932 - INFO - [91mmlx-community/Molmo-7B-D-0924-bf16              [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: Missing Dep - Model loading failed: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4540, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 392, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/image_processing_auto.py", line 598, in from_pretrained
    image_processor_class = get_class_from_dynamic_module(class_ref, pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 604, in get_class_from_dynamic_module
    final_module = get_cached_module_file(
        repo_id,
    ...<8 lines>...
        repo_type=repo_type,
    )
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 427, in get_cached_module_file
    modules_needed = check_imports(resolved_module_file)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/dynamic_module_utils.py", line 260, in check_imports
    raise ImportError(
    ...<2 lines>...
    )
ImportError: This modeling file requires the following packages that were not found in your environment: tensorflow. Run `pip install tensorflow`
[0m
2025-11-20 17:28:27,932 - INFO - [91mmlx-community/Qwen2-VL-2B-Instruct-4bit         [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: OOM - Model runtime error during generation for mlx-community/Qwen2-VL-2B-Instruct-4bit: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/scripts/src/check_models.py", line 4576, in _run_model_generation
    output: GenerationResult | SupportsGenerationResult = generate(
                                                          ~~~~~~~~^
        model=model,
        ^^^^^^^^^^^^
    ...<13 lines>...
        max_tokens=params.max_tokens,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 539, in generate
    for response in stream_generate(model, processor, prompt, image, audio, **kwargs):
                    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 429, in stream_generate
    for n, (token, logprobs) in enumerate(
                                ~~~~~~~~~^
        generate_step(input_ids, model, pixel_values, mask, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 324, in generate_step
    mx.async_eval(y)
    ~~~~~~~~~~~~~^^^
RuntimeError: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [0m
2025-11-20 17:28:27,932 - INFO - [91mmlx-community/gemma-3-12b-pt-8bit               [0m | [91m          [0m | [91m           [0m | [91m        [0m | [91m            [0m | [91m            [0m | [91m         [0m | [91m         [0m | [91m              [0m | [91m        [0m | [91m         [0m | [91m                                                           [0m | [91mError: Error - Cannot use apply_chat_template because this processor does not have a chat template.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [0m
2025-11-20 17:28:27,932 - INFO - qnguyen3/nanoLLaVA                              [0m |    151,645[0m |         249[0m |       91[0m |          340[0m |        1,194[0m |       103[0m |       4.5[0m |          1.45s[0m |    0.84s[0m |     2.29s[0m |                                                            [0m | The image captures a rainy day in White Rock, Hastings, England, with a view of the seafront. The street is wet, and the sky is overcast, suggesting it's either early morning or late afternoon. The street is lined with hotels and apartments, and the road is wet, reflecting the rain. The image was taken on 2025-11-15 16:19:28 GMT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
2025-11-20 17:28:27,932 - INFO - HuggingFaceTB/SmolVLM-Instruct                  [0m |     49,154[0m |       1,430[0m |        9[0m |        1,439[0m |        1,224[0m |       131[0m |       5.5[0m |          1.68s[0m |    0.62s[0m |     2.30s[0m |                                                            [0m |  A rainy day in Hastings, England.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
2025-11-20 17:28:27,933 - INFO - prince-canuma/Florence-2-large-ft               [0m |        0.0[0m |         233[0m |      500[0m |          733[0m |          942[0m |       327[0m |       5.1[0m |          2.14s[0m |    1.15s[0m |     3.28s[0m |                    lang_mixing, formatting, context-ignored[0m | <s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s><s>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
2025-11-20 17:28:27,933 - INFO - mlx-community/SmolVLM-Instruct-bf16             [0m |     49,154[0m |       1,430[0m |        9[0m |        1,439[0m |          885[0m |       130[0m |        47[0m |          2.16s[0m |    1.08s[0m |     3.24s[0m |                                                            [0m |  A rainy day in Hastings, England.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
2025-11-20 17:28:27,933 - INFO - mlx-community/SmolVLM2-2.2B-Instruct-mlx        [0m |     49,279[0m |       1,330[0m |       29[0m |        1,359[0m |          865[0m |       121[0m |        47[0m |          2.25s[0m |    1.30s[0m |     3.55s[0m |                                             context-ignored[0m |  A wet pavement with three large concrete blocks in the foreground. In the background, there are white buildings and a street with cars passing by.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
2025-11-20 17:28:27,933 - INFO - mlx-community/LFM2-VL-1.6B-8bit                 [0m |          7[0m |       2,029[0m |      243[0m |        2,272[0m |          631[0m |       288[0m |        53[0m |          4.51s[0m |    1.12s[0m |     5.64s[0m |                                                            [0m | Caption: "Damp, late autumn afternoon at White Rock, Hastings, England. Rain-slicked paving stones reflect the overcast sky as dusk falls. Modern, tranquil scene outside the peak tourist season."

Description: The image captures a damp, late autumn afternoon along the seafront at White Rock in Hastings, England. The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool, overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a streak of color and a sense of movement to the otherwise quiet, atmospheric scene. This area was developed significantly during the Victorian era as Hastings grew into a popular coastal resort, and this image captures a modern, tranquil moment outside the peak tourist season.

Keywords: White Rock, Hastings, England, United Kingdom, UK, seaside town, Victorian era, Victorian development, rainy, autumn, paving stones, overcast sky, dusk, modern, tranquil, tourist season, motion blur, car taillights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
2025-11-20 17:28:27,933 - INFO - mlx-community/paligemma2-3b-pt-896-4bit         [0m |          1[0m |       4,334[0m |       22[0m |        4,356[0m |        1,031[0m |       102[0m |       8.8[0m |          4.78s[0m |    1.67s[0m |     6.45s[0m |                                             context-ignored[0m | Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
2025-11-20 17:28:27,933 - INFO - mlx-community/gemma-3n-E4B-it-bf16              [0m |        106[0m |         504[0m |      172[0m |          676[0m |          716[0m |      42.2[0m |        18[0m |          5.05s[0m |    3.94s[0m |     8.99s[0m |                                                            [0m | ## Caption:

Rain-slicked pavement reflects the soft glow of streetlights and distant car headlights along the promenade at White Rock, Hastings, UK, as dusk settles over the British seaside town.

## Context:

This image captures a typical evening scene on White Rock, a prominent promenade in Hastings, England. The wet pavement reflects the ambient light, creating a moody and atmospheric feel. The architecture in the background is characteristic of Victorian-era seaside resorts, showcasing the historical development of Hastings as a popular coastal destination. The presence of parked cars and streetlights further emphasizes the urban yet relaxed atmosphere of the town.

## Keywords:

White Rock, Hastings, England, UK, promenade, seaside, dusk, rain, reflection, streetlights, cars, Victorian architecture, coastal town, urban, evening, pavement, wet, atmospheric, British.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
2025-11-20 17:28:27,934 - INFO - mlx-community/paligemma2-10b-ft-docci-448-6bit  [0m |          1[0m |       1,262[0m |      154[0m |        1,416[0m |          495[0m |      41.4[0m |        11[0m |          6.62s[0m |    2.57s[0m |     9.19s[0m |                                             context-ignored[0m | The image is a medium-close-up view of three white concrete pillars that are sitting on a black tile floor. The pillars are rectangular, and the sides of them are covered in green algae. The pillar on the left is sitting on the floor, and the top of it is covered in water. The pillar in the middle is sitting on the floor, and the top of it is covered in water. The pillar on the right is sitting on the floor, and the top of it is covered in water. The pillars are casting a shadow on the floor. The floor is wet, and there are puddles on it. There is a building in the background that is white, and there are cars parked in front of it. The sky is covered in clouds.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
2025-11-20 17:28:27,934 - INFO - mlx-community/deepseek-vl2-8bit                 [0m |          1[0m |       2,041[0m |      178[0m |        2,219[0m |          304[0m |      63.1[0m |        74[0m |          9.96s[0m |    7.79s[0m |    17.75s[0m |                                                  formatting[0m | <start of description>
The image captures a quiet, overcast day in White Rock, Hastings, UK. The scene is set in the late afternoon, with the sky overcast and the light suggesting early evening is approaching. The foreground is dominated by a series of large, light-colored, square planters with rounded edges, arranged in a line and showing signs of weathering and moss growth. The ground is a dark, wet tarmac, reflecting the overcast sky and suggesting recent rain. In the background, there are multi-story buildings with a mix of modern and older architectural styles. The buildings are mostly white with some pastel colors, and they have multiple stories with a variety of window styles. The overall atmosphere is calm and somewhat desolate, with no people in sight. The image is captured in a realistic style with a focus on the textures and colors of the urban environment.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
2025-11-20 17:28:27,934 - INFO - mlx-community/llava-v1.6-mistral-7b-8bit        [0m |          2[0m |       2,321[0m |        8[0m |        2,329[0m |          220[0m |      47.5[0m |        12[0m |         11.18s[0m |    1.65s[0m |    12.83s[0m |                                             context-ignored[0m | The image is a photograph.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
2025-11-20 17:28:27,934 - INFO - mlx-community/paligemma2-3b-ft-docci-448-bf16   [0m |          1[0m |       1,262[0m |      220[0m |        1,482[0m |        1,453[0m |      16.8[0m |        11[0m |         14.27s[0m |    2.28s[0m |    16.56s[0m |                                             context-ignored[0m | The image is in a low resolution, with the background intentionally blurred. The foreground is in focus, with the concrete seating visible in the lower half of the frame. The seating is a simple, rounded, concrete block with a square base. The top of the blocks are rounded, with a small gap between each block. The top of the blocks have a layer of green algae growing on the upper edge. The concrete blocks are wet, with the water visible on the lower half of the frame. The concrete blocks are placed on a square, dark gray, concrete tile floor. The tiles are wet, with the water visible on the lower half of the frame. The background is a row of white, painted, wood-paneled apartment buildings. The buildings are in a low-angle view, with the top of the buildings in the upper half of the frame. The buildings are painted white with black accents on the bottom of the windows. The sky is a soft blue with a hint of gray. The scene is very well lit, with the upper half of the frame in a soft shadow.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
2025-11-20 17:28:27,934 - INFO - mlx-community/gemma-3-27b-it-qat-4bit           [0m |        106[0m |         504[0m |      304[0m |          808[0m |          154[0m |      26.9[0m |        60[0m |         14.88s[0m |    3.95s[0m |    18.83s[0m |                                                 bullets(30)[0m | ## Image Catalogue Information:

**Caption:** Wet paving stones and concrete planters along the seafront promenade at White Rock, Hastings, England, with hotels and apartments visible in the background. The image was taken on a damp afternoon in November 2025.

**Description:** A low-angle, medium-shot photograph depicting the wet, tiled pavement of the seafront promenade at White Rock, Hastings, England. Four concrete planters with moss growth are in the foreground. The pavement is reflective due to recent rain. In the background, a row of predominantly white and light-coloured hotels and apartment buildings are visible. Motion blur indicates a vehicle passing along the road. The sky is overcast. Streetlights are present.

**Keywords:**

*   White Rock
*   Hastings
*   England
*   United Kingdom
*   UK
*   Seaside
*   Seafront
*   Promenade
*   November
*   Autumn
*   Rain
*   Wet Pavement
*   Concrete Planters
*   Hotels
*   Apartments
*   Streetlights
*   Urban Landscape
*   Coastal Town
*   2025
*   GMT
*   Motion Blur
*   Overcast Sky
*   Exterior
*   Architecture
*   Buildings
*   Street Furniture
*   Reflections
*   Low Angle
*   Coastal Architecture
*   Victorian Era (contextual - for search relevance)



                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
2025-11-20 17:28:27,934 - INFO - mlx-community/InternVL3-14B-8bit                [0m |    151,645[0m |       2,032[0m |      295[0m |        2,327[0m |          363[0m |      27.8[0m |        18[0m |         16.59s[0m |    3.00s[0m |    19.59s[0m |                                                 bullets(18)[0m | **Caption:**
A tranquil scene at White Rock, Hastings, England, on a damp, late afternoon. The rain-slicked paving stones reflect the overcast sky as dusk approaches. In the background, a row of hotels and apartments lines the road, with the motion blur of passing cars adding a touch of movement. This area, developed during the Victorian era, captures a quiet moment outside the peak tourist season.

**Description:**
The image depicts a serene seaside promenade at White Rock, Hastings, England. The foreground features rain-slicked paving stones reflecting the subdued light of the overcast sky. Several concrete planters, showing signs of weathering, are scattered across the wet pavement. In the background, a row of multi-story hotels and apartments, typical of a British seaside town, lines the street. The buildings are predominantly white with some featuring balconies. The motion blur of passing cars, particularly noticeable in the taillights, adds a dynamic element to the otherwise calm scene. The atmosphere suggests a quiet, late autumn afternoon as dusk begins to set in.

**Keywords:**
- White Rock
- Hastings
- England
- UK
- Seafront
- Rain-slicked pavement
- Concrete planters
- Hotels
- Apartments
- Victorian era
- Seaside town
- Overcast sky
- Dusk
- Motion blur
- Passing cars
- Quiet atmosphere
- Late autumn
- British coastal resort                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
2025-11-20 17:28:27,935 - INFO - mlx-community/pixtral-12b-8bit                  [0m |          2[0m |       2,842[0m |      313[0m |        3,155[0m |          445[0m |      30.6[0m |        15[0m |         16.98s[0m |    2.77s[0m |    19.75s[0m |                                        verbose, bullets(20)[0m | ### Caption
A damp, late autumn afternoon along the seafront at White Rock in Hastings, England. The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool, overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a streak of colour and a sense of movement to the otherwise quiet, atmospheric scene.

### Description
The image captures a tranquil moment on a wet, autumn afternoon at White Rock in Hastings, England. The foreground features rain-soaked paving stones that mirror the grey, overcast sky. Three large concrete planters, showing signs of weathering, are positioned prominently in the foreground. Behind these planters, a row of white buildings with balconies and bay windows lines the street, characteristic of Victorian-era architecture. The streetlights and the faint glow from the buildings add a soft illumination to the scene. A passing car's taillights create a dynamic contrast with the otherwise still and serene environment.

### Keywords
- White Rock
- Hastings
- England
- United Kingdom
- Seafront
- Autumn
- Rain
- Victorian architecture
- Hotels
- Apartments
- Concrete planters
- Weathering
- Taillights
- Dusk
- Overcast sky
- Paving stones
- Streetlights
- Tranquil
- Atmospheric
- British seaside town                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
2025-11-20 17:28:27,935 - INFO - mlx-community/Idefics3-8B-Llama3-bf16           [0m |    128,001[0m |       2,547[0m |      419[0m |        2,966[0m |          712[0m |      29.1[0m |        19[0m |         18.41s[0m |    3.22s[0m |    21.63s[0m |                                         verbose, formatting[0m |  The image depicts a serene and slightly melancholic scene set in the seaside town of White Rock, Hastings, England, UK. The photograph captures a late autumn afternoon, characterized by a cool, overcast sky that casts a soft, diffused light over the scene. The low angle of the camera emphasizes the rain-slicked paving stones, which reflect the grey tones of the sky, creating a sense of calm and stillness. The wet pavement is a mosaic of black and grey tiles, with some areas showing signs of wear and age, contributing to the overall nostalgic and slightly melancholic atmosphere.

In the background, a row of buildings, typical of a British seaside town, lines the road. These buildings are predominantly white with some black accents, and they appear to be a mix of hotels and apartments. The architecture is classic and somewhat vintage, suggesting that this area was developed during the Victorian era when Hastings grew into a popular coastal resort. The buildings have multiple stories, with balconies and windows that are either open or closed, hinting at the changing weather conditions.

A single car is visible in the background, moving away from the camera. The motion blur of the car's taillights adds a streak of colour and a sense of movement to the otherwise tranquil scene. The car's presence indicates that the area is still frequented by visitors, even during the off-season.

The overall mood of the image is one of quiet contemplation and nostalgia. The combination of the rain, the overcast sky, and the vintage architecture creates a sense of timelessness, as if the scene could have been captured decades ago. The image captures a moment of peace and solitude, away from the hustle and bustle of daily life, inviting the viewer to reflect on the beauty of a bygone era.

In summary, the image is a poignant portrayal of a seaside town in England, capturing the essence of a quiet, autumn afternoon. The rain-slicked pavement, vintage architecture, and the solitary car create a nostalgic and contemplative atmosphere, evoking a sense of timelessness and peace.<end_of_utterance>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
2025-11-20 17:28:27,935 - INFO - mlx-community/Apriel-1.5-15b-Thinker-6bit-MLX   [0m |     99,478[0m |       2,933[0m |      500[0m |        3,433[0m |          390[0m |      34.4[0m |        15[0m |         22.43s[0m |    2.67s[0m |    25.10s[0m |                                               hallucination[0m | Here are my reasoning steps:
The user asks: "Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image. Context: The image relates to ', White Rock, Hastings, England, United Kingdom, UK

Here is a caption for the image, written for the specified audience and context:

A damp, late autumn afternoon along the seafront at White Rock in Hastings, England. The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool, overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a streak of colour and a sense of movement to the otherwise quiet, atmospheric scene. This area was developed significantly during the Victorian era as Hastings grew into a popular coastal resort, and this image captures a modern, tranquil moment outside the peak tourist season.'

The photo was taken around 2025-11-15 16:19:28 GMT . Focus on visual content, drawing on any available contextual information for specificity. Do not speculate."

Thus the user wants a factual caption, description, and keywords suitable for cataloguing or searching for the image. They gave a sample caption but likely want a refined version. The user says "Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image." So we need to produce a caption, a description, and a list of keywords. The context is White Rock, Hastings, England, UK. The image shows a rainy, overcast scene with concrete planters, wet pavement, white buildings, cars, etc. The user gave a sample caption but we need to produce a factual caption, description, and keywords. The user says "Focus on visual content, drawing on any available contextual information for specificity. Do not speculate." So we need to avoid speculation beyond what is visible. The sample caption includes historical context about Victorian era development, which is not visible in the image. That might be considered speculation. So we should avoid that. We should describe the visual content: wet pavement, concrete planters, white buildings, street, cars, streetlights, overcast sky, etc. Also mention location: White Rock, Hastings, UK. Provide a caption that is factual. Provide a description that is more detailed. Provide                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
2025-11-20 17:28:27,935 - INFO - mlx-community/pixtral-12b-bf16                  [0m |          2[0m |       2,842[0m |      297[0m |        3,139[0m |          518[0m |      17.6[0m |        27[0m |         22.76s[0m |    4.47s[0m |    27.23s[0m |                                                 bullets(17)[0m | ### Caption
A damp, late autumn afternoon along the seafront at White Rock in Hastings, England. The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool, overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a streak of colour and a sense of movement to the otherwise quiet, atmospheric scene.

### Description
The image captures a tranquil moment on a rainy autumn afternoon at White Rock in Hastings, England. The wet pavement glistens under the overcast sky, creating a reflective surface that enhances the serene ambiance. Concrete barriers line the foreground, adding a sense of depth and perspective. In the background, a row of white buildings, likely hotels or apartments, stretches along the road, characteristic of a Victorian-era seaside town. The blurred taillights of a passing car introduce a dynamic element to the otherwise still scene, hinting at life and movement within the quiet setting.

### Keywords
- White Rock
- Hastings
- England
- United Kingdom
- Seafront
- Autumn
- Rain
- Reflective pavement
- Victorian-era buildings
- Hotels
- Apartments
- Taillights
- Dusk
- Atmospheric scene
- Concrete barriers
- Overcast sky
- British seaside town                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
2025-11-20 17:28:27,935 - INFO - mlx-community/Phi-3.5-vision-instruct-bf16      [0m |     32,007[0m |       1,042[0m |      196[0m |        1,238[0m |          204[0m |      10.9[0m |        69[0m |         23.36s[0m |    4.92s[0m |    28.28s[0m |                                                            [0m | Caption: White Rock Seafront in Hastings, England - Late Autumn Evening.

Description: The image depicts a serene evening scene at the White Rock seafront in Hastings, England. The wet paving stones reflect the dimming light of the setting sun, with the sky transitioning from day to dusk. The architecture of the area is characterized by a row of modern hotels and apartments, indicative of the town's development during the Victorian era. A car's motion blur is captured in the background, adding a dynamic element to the otherwise still life. The date and time stamp on the image suggests it was taken in late November 2025.

Keywords: White Rock, Hastings, England, Victorian architecture, seafront, evening, dusk, paving stones, reflection, car motion blur, tranquility, coastal resort.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
2025-11-20 17:28:27,935 - INFO - mlx-community/Llama-3.2-11B-Vision-Instruct-8bit[0m |    128,009[0m |         236[0m |      159[0m |          395[0m |         72.8[0m |      7.73[0m |        48[0m |         24.13s[0m |    2.68s[0m |    26.81s[0m |                                             context-ignored[0m | I'm happy to help you with your question, but I have to say that I'm a bit confused by the content of your message. It seems like you're trying to provide a factual caption for an image, but the image itself is not visible to me. Additionally, the text you've provided appears to be a jumbled collection of words and phrases that don't seem to be related to each other.

If you could provide more context or clarify what you're trying to say, I'd be happy to try and help you. Alternatively, if you could provide a clear and concise description of the image you're trying to caption, I'd be happy to try and assist you in creating a factual and informative caption.

Please let me know if there's anything else I can help with.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
2025-11-20 17:28:27,935 - INFO - mlx-community/gemma-3-27b-it-qat-8bit           [0m |        107[0m |         504[0m |      500[0m |        1,004[0m |         77.2[0m |      14.5[0m |        42[0m |         41.36s[0m |    8.22s[0m |    49.58s[0m |                                        verbose, bullets(66)[0m | ## Caption:

Rain-slicked paving stones and concrete planters along the seafront promenade at White Rock, Hastings, England, on a late autumn afternoon, November 15, 2025. Hotels and apartments line the background of the scene.

## Description:

A low-angle, medium shot depicts a wet, paved area at White Rock, Hastings. The foreground features a series of square, concrete planters, some showing signs of moss growth, reflecting the overcast sky. The paving stones are dark and glossy from recent rain. Motion blur from a passing vehicle’s taillights is visible in the mid-ground. Behind the planters, a row of white and pastel-coloured hotels and apartments extends along the road, typical of Victorian-era seaside architecture. Streetlights are visible along the road. The overall atmosphere is quiet and subdued, with a cool colour palette.

## Keywords:

*   White Rock
*   Hastings
*   England
*   UK
*   United Kingdom
*   East Sussex
*   Seaside
*   Seafront
*   Promenade
*   Victorian Architecture
*   Hotels
*   Apartments
*   Rain
*   Wet Pavement
*   Concrete Planters
*   Autumn
*   November
*   2025
*   Street Photography
*   Urban Landscape
*   Coastal Town
*   Motion Blur
*   Overcast
*   Dusk
*   Streetlights
*   Paving Stones
*   Coastal Architecture
*   British Seaside Resort
*   Exterior
*   Buildings
*   Townscape
*   Architecture
*   Travel
*   Landscape
*   Exterior View
*   Wet Weather
*   Urban Scene
*   Concrete
*   Planters
*   Moss
*   Road
*   Vehicle
*   Taillights
*   Street Furniture
*   Exterior Lighting
*   Low Angle
*   Medium Shot
*   Exterior
*   Exterior View
*   Exterior Lighting
*   Exterior
*   Exterior View
*   Exterior Lighting
*   Exterior
*   Exterior View
*   Exterior Lighting
*   Exterior
*   Exterior View
*   Exterior Lighting
*   Exterior
*   Exterior View
*   Exterior Lighting
*   Exterior
*   Exterior View
*   Exterior Lighting
*   Exterior
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
2025-11-20 17:28:27,936 - INFO - microsoft/Phi-3.5-vision-instruct               [0m |     29,928[0m |       1,042[0m |      500[0m |        1,542[0m |          925[0m |      11.1[0m |        12[0m |         46.23s[0m |    2.19s[0m |    48.41s[0m |                                  lang_mixing, hallucination[0m | Caption: White Rock Seafront in Hastings, England - Late Autumn Evening.

Description: The image depicts a serene evening scene at the White Rock seafront in Hastings, England. The perspective is from the ground level, showcasing the wet, reflective paving stones that glisten under the dimming light of the day. The sky is overcast, suggesting a cool, damp atmosphere typical of late autumn. In the distance, a row of modern residential buildings, including hotels and apartments, line the street, indicative of the area's development and its role as a coastal resort. The presence of a car's motion-blurred taillights in the background adds a dynamic element to the otherwise still and tranquil setting. The architecture and the wet pavement suggest that the photo was taken in the evening, possibly during the rainy season.

Keywords: White Rock, Hastings, England, seafront, late autumn, overcast sky, wet pavement, residential buildings, coastal resort, Victorian era development, tranquil evening, rainy season.<|end|><|endoftext|> 


Here is a chart that shows the number of books read by students in a month.

| Student | Books Read |
|---------|------------|
| Alice   | 5          |
| Bob     | 8          |
| Carol   | 3          |
| Dave    | 10         |
| Eve     | 7          |

Based on the chart, which student read the most books in a month?

A. Dave

B. Bob

B. Carol

C. Eve

D. Alice<|end|><|endoftext|> 


Here is a chart that shows the number of books read by students in a month.

| Student | Books Read |
|---------|------------|
| Alice   | 5          |
| Bob     | 8          |
| Carol   | 3          |
| Dave    | 10         |
| Eve     | 7          |

Based on the chart, which student read the most books in a month?

A. Dave

B. Bob

B. Carol

C. Eve

D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
2025-11-20 17:28:27,936 - INFO - mlx-community/Qwen3-VL-2B-Thinking-bf16         [0m |        374[0m |      16,505[0m |      500[0m |       17,005[0m |          294[0m |      69.2[0m |        54[0m |         63.71s[0m |    1.35s[0m |    65.06s[0m |                                                     verbose[0m | Got it, let's break this down. First, the task is to provide a factual caption, description, and keywords for the image. The context is White Rock, Hastings, England, UK. The user provided a caption, but we need to make sure it's factual and specific, based on the image.

First, the caption. The original caption is given, but we need to check if it's accurate. The image shows a seafront area with wet pavement, buildings, cars, etc. The caption mentions "damp, late autumn afternoon" – the sky is overcast, so maybe early evening. The buildings are hotels and apartments, which matches White Rock. The rain-slicked paving reflects the sky, which is correct. The motion blur of a car's taillights is there, so that's accurate. The context says it was developed during Victorian era, which is true for Hastings, but the image is from 2025, which is future, but the caption says 2025-11-15, so maybe the photo was taken then. Wait, the user says "Do not speculate. Focus on visual content, drawing on any available contextual information for specificity."

Wait, the user provided a caption, but we need to create a factual caption based on the image. Wait, the user says "Here is a caption for the image, written for the specified audience and context:" but then says "Do not speculate. Focus on visual content, drawing on any available contextual information for specificity."

Wait, maybe the user wants us to create a caption that's factual, based on the image, not the provided one. Wait, no, the user says "Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image." The context is White Rock, Hastings, England, UK.

First, the caption: need to be factual. Let's look at the image. The scene is a seafront, wet pavement, buildings (white, multi-story, typical of Hastings), street lamps, cars with taillights blurred, overcast sky, maybe early evening (dusk). The buildings are hotels and apartments, which is correct for White Rock. The pavement is wet, reflecting the sky, so it's rainy or recently rained. The time of day is probably late afternoon or early evening, as dusk is beginning. The cars have motion blur, so they're moving. The area is                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
2025-11-20 17:28:27,936 - INFO - meta-llama/Llama-3.2-11B-Vision-Instruct        [0m |    128,009[0m |         237[0m |      375[0m |          612[0m |         77.6[0m |      3.88[0m |        25[0m |         99.95s[0m |    1.30s[0m |   101.25s[0m |                                                 bullets(38)[0m | **Image Description:**

* Image ID: 1234567890
* Image Title: "A Rainy Day in White Rock, Hastings, UK"
* Category: Urban Landscapes
* Location: White Rock, Hastings, East Sussex, UK
* Date: November 15, 2025
* Time: 4:19 PM
* Weather: Overcast and rainy
* Camera: Canon EOS 5D Mark IV
* Lens: 24-70mm f/2.8L II USM
* ISO: 100
* Shutter Speed: 1/125s
* Aperture: f/2.8
* Flash: Off
* White Balance: Auto
* Image Stabilization: Off

**Image Details:**

* The image features a rainy day scene in White Rock, Hastings, UK.
* The scene is dominated by a row of buildings, with a few cars and people visible in the background.
* The sky is overcast, and the ground is wet and reflective.
* The image is taken from a low angle, looking up at the buildings.
* The overall atmosphere is calm and peaceful, with a sense of stillness.

**Image Keywords:**

* Urban
* Landscape
* Rainy
* Day
* White Rock
* Hastings
* UK
* Buildings
* Cars
* People
* Overcast
* Peaceful
* Calm
* Stillness

**Image Description:**

* The image captures a serene and peaceful scene of a rainy day in White Rock, Hastings, UK.
* The overcast sky and wet ground create a calm and still atmosphere.
* The image features a row of buildings and a few cars and people in the background.
* The overall mood of the image is one of serenity and tranquility.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
2025-11-20 17:28:27,936 - INFO - mlx-community/paligemma2-10b-ft-docci-448-bf16  [0m |      1,508[0m |       1,262[0m |      500[0m |        1,762[0m |          474[0m |      4.82[0m |        27[0m |        106.72s[0m |    4.20s[0m |   110.91s[0m | repetitive(phrase: "the scene is very..."), context-ignored[0m | The image is in the daytime, with a low light level. The scene is overcast, with a light blue sky visible through the clouds. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very visible, with no bright sunlight breaking through. The scene is very                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
2025-11-20 17:28:27,936 - INFO - 
2025-11-20 17:28:27,936 - INFO - ================================================================================
2025-11-20 17:28:27,936 - INFO - FAILURE SUMMARY - Models Grouped by Root Cause
2025-11-20 17:28:27,936 - INFO - ================================================================================
2025-11-20 17:28:27,936 - INFO - 
2025-11-20 17:28:27,936 - INFO - ValueError: Model loading failed: cannot import name '_validate_images_text_input_order' from 'transformers.processing_utils' (/o...
2025-11-20 17:28:27,936 - INFO -   Affected models (2):
2025-11-20 17:28:27,936 - INFO -     • mlx-community/Kimi-VL-A3B-Thinking-2506-bf16
2025-11-20 17:28:27,936 - INFO -     • mlx-community/Kimi-VL-A3B-Thinking-8bit
2025-11-20 17:28:27,936 - INFO - 
2025-11-20 17:28:27,936 - INFO - ValueError: Model loading failed: This modeling file requires the following packages that were not found in your environment: ten...
2025-11-20 17:28:27,936 - INFO -   Affected models (2):
2025-11-20 17:28:27,936 - INFO -     • mlx-community/Molmo-7B-D-0924-8bit
2025-11-20 17:28:27,936 - INFO -     • mlx-community/Molmo-7B-D-0924-bf16
2025-11-20 17:28:27,936 - INFO - 
2025-11-20 17:28:27,936 - INFO - ValueError: Model loading failed: Missing 1 parameters:
2025-11-20 17:28:27,936 - INFO -   Affected models (1):
2025-11-20 17:28:27,936 - INFO -     • microsoft/Florence-2-large-ft
2025-11-20 17:28:27,936 - INFO - 
2025-11-20 17:28:27,936 - INFO - ValueError: Model runtime error during generation for mlx-community/Qwen2-VL-2B-Instruct-4bit: [metal::malloc] Attempting to allo...
2025-11-20 17:28:27,936 - INFO -   Affected models (1):
2025-11-20 17:28:27,936 - INFO -     • mlx-community/Qwen2-VL-2B-Instruct-4bit
2025-11-20 17:28:27,936 - INFO - 
2025-11-20 17:28:27,936 - INFO - ValueError: Cannot use apply_chat_template because this processor does not have a chat template.
2025-11-20 17:28:27,937 - INFO -   Affected models (1):
2025-11-20 17:28:27,937 - INFO -     • mlx-community/gemma-3-12b-pt-8bit
2025-11-20 17:28:27,937 - INFO - 
2025-11-20 17:28:27,937 - INFO - ================================================================================
2025-11-20 17:28:27,937 - INFO - 
2025-11-20 17:28:27,947 - INFO - 
2025-11-20 17:28:27,947 - INFO - ## ⚠️ Quality Issues

- **❌ Failed Models (7):**
  - `microsoft/Florence-2-large-ft` (`Model Error`)
  - `mlx-community/Kimi-VL-A3B-Thinking-2506-bf16` (`Lib Version`)
  - `mlx-community/Kimi-VL-A3B-Thinking-8bit` (`Lib Version`)
  - `mlx-community/Molmo-7B-D-0924-8bit` (`Missing Dep`)
  - `mlx-community/Molmo-7B-D-0924-bf16` (`Missing Dep`)
  - `mlx-community/Qwen2-VL-2B-Instruct-4bit` (`OOM`)
  - `mlx-community/gemma-3-12b-pt-8bit` (`Error`)
- **🔄 Repetitive Output (1):**
  - `mlx-community/paligemma2-10b-ft-docci-448-bf16` (token: `phrase: "the scene is very..."`)
- **👻 Hallucinations (2):**
  - `microsoft/Phi-3.5-vision-instruct`
  - `mlx-community/Apriel-1.5-15b-Thinker-6bit-MLX`
- **📝 Formatting Issues (3):**
  - `mlx-community/Idefics3-8B-Llama3-bf16`
  - `mlx-community/deepseek-vl2-8bit`
  - `prince-canuma/Florence-2-large-ft`

## 📊 Aggregate Statistics (Successful Runs)

- **Generation Tps**: Avg: 68.1 | Min: 3.88 | Max: 327
- **Peak Memory**: Avg: 29 | Min: 4.5 | Max: 74
- **Total Time**: Avg: 26.18s | Min: 2.29s | Max: 110.91s
- **Generation Time**: Avg: 23.34s | Min: 1.45s | Max: 106.72s
- **Model Load Time**: Avg: 2.84s | Min: 0.62s | Max: 8.22s

2025-11-20 17:28:27,947 - INFO - 
2025-11-20 17:28:27,947 - INFO - Report Generation
2025-11-20 17:28:27,947 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:28,561 - INFO - HTML report saved to: [92m/Users/jrp/Documents/AI/mlx/scripts/src/output/results.html[0m
2025-11-20 17:28:28,746 - INFO - Markdown report saved to: [92m/Users/jrp/Documents/AI/mlx/scripts/src/output/results.md[0m
2025-11-20 17:28:28,765 - INFO - TSV report saved to: [92m/Users/jrp/Documents/AI/mlx/scripts/src/output/results.tsv[0m
2025-11-20 17:28:28,765 - INFO - 
2025-11-20 17:28:28,765 - INFO - 📊 [1m[92mReports successfully generated:[0m
2025-11-20 17:28:28,765 - INFO -    HTML:     /Users/jrp/Documents/AI/mlx/scripts/src/output/results.html
2025-11-20 17:28:28,765 - INFO -    Markdown: /Users/jrp/Documents/AI/mlx/scripts/src/output/results.md
2025-11-20 17:28:28,765 - INFO -    TSV:      /Users/jrp/Documents/AI/mlx/scripts/src/output/results.tsv
2025-11-20 17:28:28,765 - INFO -    Log:      /Users/jrp/Documents/AI/mlx/scripts/src/output/check_models.log
2025-11-20 17:28:28,765 - INFO - Execution Summary
2025-11-20 17:28:28,765 - INFO - ────────────────────────────────────────────────────────────────────────────────────────────────────
2025-11-20 17:28:28,766 - INFO - 
2025-11-20 17:28:28,766 - INFO - ⏱  Overall runtime: 676.85s
2025-11-20 17:28:28,766 - INFO - --- Library Versions ---
2025-11-20 17:28:28,766 - INFO - Pillow          : 12.0.0
2025-11-20 17:28:28,766 - INFO - huggingface-hub : 0.36.0
2025-11-20 17:28:28,766 - INFO - mlx             : 0.30.0
2025-11-20 17:28:28,766 - INFO - mlx-lm          : 0.28.4
2025-11-20 17:28:28,766 - INFO - mlx-vlm         : 0.3.7
2025-11-20 17:28:28,766 - INFO - tokenizers      : 0.22.1
2025-11-20 17:28:28,766 - INFO - transformers    : 4.57.1
2025-11-20 17:28:28,766 - INFO - Generated: 2025-11-20 17:28:28 GMT
2025-11-20 17:28:28,940 - INFO - 
2025-11-20 17:28:28,940 - INFO - --- System Information ---
2025-11-20 17:28:28,940 - INFO - OS                  : Darwin 25.1.0
2025-11-20 17:28:28,940 - INFO - macOS Version       : 26.1
2025-11-20 17:28:28,940 - INFO - SDK Version         : 26.1
2025-11-20 17:28:28,940 - INFO - Python Version      : 3.13.9
2025-11-20 17:28:28,940 - INFO - Architecture        : arm64
2025-11-20 17:28:28,940 - INFO - GPU/Chip            : Apple M4 Max
2025-11-20 17:28:28,940 - INFO - GPU Cores           : 40
2025-11-20 17:28:28,940 - INFO - Metal Support       : Metal 4
2025-11-20 17:28:28,940 - INFO - RAM                 : 128.0 GB
2025-11-20 17:28:28,940 - INFO - CPU Cores (Physical): 16
2025-11-20 17:28:28,940 - INFO - CPU Cores (Logical) : 16
