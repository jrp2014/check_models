2025-11-24 23:56:21,649 - INFO - Full environment dump written to:
2025-11-24 23:56:21,649 - INFO - /Users/jrp/Documents/AI/mlx/check_models/src/output/environment.log
2025-11-24 23:56:21,649 - DEBUG - Environment details saved for reproducibility
2025-11-24 23:56:21,649 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:21,649 - WARNING - âš ï¸  SECURITY WARNING: --trust-remote-code is enabled.
2025-11-24 23:56:21,649 - WARNING - âš ï¸  This allows execution of remote code and may pose security risks.
2025-11-24 23:56:21,649 - INFO - ====================================================================================================
2025-11-24 23:56:21,649 - INFO - MLX Vision Language Model Check
2025-11-24 23:56:21,649 - INFO - ====================================================================================================
2025-11-24 23:56:21,649 - INFO - Image File:      /Users/jrp/Downloads/National_monument_Edinburgh.jpg
2025-11-24 23:56:21,657 - INFO - Image dimensions: 1080x1920 (2.1 MPixels)
2025-11-24 23:56:21,657 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:21,657 - INFO - Image Metadata
2025-11-24 23:56:21,659 - INFO - Date: 2010-09-30 12:58:31 BST
2025-11-24 23:56:21,660 - INFO - Description: 
2025-11-24 23:56:21,660 - INFO - GPS Location: 
2025-11-24 23:56:21,660 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:21,660 - INFO - Prompt Configuration
2025-11-24 23:56:21,660 - INFO - Generating default prompt based on image metadata.
2025-11-24 23:56:21,660 - DEBUG - Using generated prompt based on metadata.
2025-11-24 23:56:21,660 - INFO - Final prompt: Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image. 

The photo was taken around 2010-09-30 12:58:31 BST . Focus on visual content, drawing on a...
2025-11-24 23:56:21,660 - INFO - Processing specified models: Qwen/Qwen3-VL-2B-Instruct
2025-11-24 23:56:21,660 - INFO - Processing 1 model(s)...
2025-11-24 23:56:21,660 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:21,660 - INFO - 
2025-11-24 23:56:21,660 - INFO - Processing Model [1/1]: Qwen/Qwen3-VL-2B-Instruct
2025-11-24 23:56:21,824 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-24 23:56:22,867 - ERROR - Failed to load model Qwen/Qwen3-VL-2B-Instruct
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/check_models/src/check_models.py", line 4615, in _run_model_generation
    model, tokenizer = load(
                       ~~~~^
        path_or_hf_repo=params.model_identifier,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lazy=params.lazy,
        ^^^^^^^^^^^^^^^^^
        trust_remote_code=params.trust_remote_code,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 306, in load
    processor = load_processor(model_path, True, eos_token_ids=eos_token_id, **kwargs)
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/utils.py", line 364, in load_processor
    processor = AutoProcessor.from_pretrained(model_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/models/auto/processing_auto.py", line 396, in from_pretrained
    return processor_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, trust_remote_code=trust_remote_code, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1394, in from_pretrained
    args = cls._get_arguments_from_pretrained(pretrained_model_name_or_path, **kwargs)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/processing_utils.py", line 1453, in _get_arguments_from_pretrained
    args.append(attribute_class.from_pretrained(pretrained_model_name_or_path, **kwargs))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/tokenization_utils_base.py", line 2112, in from_pretrained
    return cls._from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~^
        resolved_vocab_files,
        ^^^^^^^^^^^^^^^^^^^^^
    ...<9 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/mlx-vlm/lib/python3.13/site-packages/transformers/tokenization_utils_base.py", line 2419, in _from_pretrained
    if _is_local and _config.model_type not in [
                     ^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'model_type'
2025-11-24 23:56:22,888 - DEBUG - HF Cache Info for Qwen/Qwen3-VL-2B-Instruct: size=4069.0 MB, files=10
2025-11-24 23:56:22,889 - DEBUG - Cleaned up resources for model Qwen/Qwen3-VL-2B-Instruct
2025-11-24 23:56:22,889 - ERROR - [RUN 1/1] SUMMARY model=Qwen/Qwen3-VL-2B-Instruct status=FAIL stage=Error
2025-11-24 23:56:22,889 - INFO - 
2025-11-24 23:56:22,889 - INFO - 
2025-11-24 23:56:22,889 - INFO - Error: Model loading failed: 'dict' object has no attribute 'model_type'
2025-11-24 23:56:22,889 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:22,889 - INFO - Performance Summary
2025-11-24 23:56:22,890 - INFO - Model                        Generation    Load    Total  Quality    Output
2025-11-24 23:56:22,890 - INFO - Name                                (s)     (s)      (s)  Issues
2025-11-24 23:56:22,890 - INFO - Qwen/Qwen3-VL-2B-Instruct                                            Error: Error - Model loading failed: 'dict' object
2025-11-24 23:56:22,890 - INFO -                                                                      has no attribute 'model_type'
2025-11-24 23:56:22,890 - INFO - 
2025-11-24 23:56:22,890 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:22,890 - INFO - Results Summary
2025-11-24 23:56:22,890 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:22,890 - INFO - âŒ Failed Models (1):
2025-11-24 23:56:22,890 - INFO -   - Qwen/Qwen3-VL-2B-Instruct (Error)
2025-11-24 23:56:22,890 - INFO - 
2025-11-24 23:56:23,251 - INFO - 
2025-11-24 23:56:23,251 - INFO - ğŸ“Š Reports successfully generated:
2025-11-24 23:56:23,251 - INFO -    HTML Report: /Users/jrp/Documents/AI/mlx/check_models/src/output/results.html
2025-11-24 23:56:23,251 - INFO -    Markdown Report: /Users/jrp/Documents/AI/mlx/check_models/src/output/results.md
2025-11-24 23:56:23,251 - INFO -    TSV Report:    /Users/jrp/Documents/AI/mlx/check_models/src/output/results.tsv
2025-11-24 23:56:23,251 - INFO -    JSONL Report:  /Users/jrp/Documents/AI/mlx/check_models/src/output/results.jsonl
2025-11-24 23:56:23,251 - INFO -    Log File: /Users/jrp/Documents/AI/mlx/check_models/src/output/check_models.log
2025-11-24 23:56:23,251 - INFO -    Environment: /Users/jrp/Documents/AI/mlx/check_models/src/output/environment.log
2025-11-24 23:56:23,251 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-24 23:56:23,251 - INFO - Final Summary
2025-11-24 23:56:23,251 - INFO - 
2025-11-24 23:56:23,251 - INFO - â±  Overall runtime: 2.51s
2025-11-24 23:56:23,251 - INFO - --- Library Versions ---
2025-11-24 23:56:23,251 - INFO - Pillow          : 12.0.0
2025-11-24 23:56:23,251 - INFO - huggingface-hub : 0.36.0
2025-11-24 23:56:23,251 - INFO - mlx             : 0.30.1.dev20251124+1d4eacb7
2025-11-24 23:56:23,251 - INFO - mlx-lm          : 0.28.4
2025-11-24 23:56:23,251 - INFO - mlx-vlm         : 0.3.7
2025-11-24 23:56:23,251 - INFO - tokenizers      : 0.22.1
2025-11-24 23:56:23,251 - INFO - transformers    : 4.57.2
2025-11-24 23:56:23,251 - INFO - Generated: 2025-11-24 23:56:23 GMT
2025-11-24 23:56:23,416 - INFO - 
2025-11-24 23:56:23,416 - INFO - --- System Information ---
2025-11-24 23:56:23,416 - INFO - OS                  : Darwin 25.1.0
2025-11-24 23:56:23,416 - INFO - macOS Version       : 26.1
2025-11-24 23:56:23,416 - INFO - SDK Version         : 26.1
2025-11-24 23:56:23,416 - INFO - Python Version      : 3.13.9
2025-11-24 23:56:23,416 - INFO - Architecture        : arm64
2025-11-24 23:56:23,416 - INFO - GPU/Chip            : Apple M4 Max
2025-11-24 23:56:23,416 - INFO - GPU Cores           : 40
2025-11-24 23:56:23,416 - INFO - Metal Support       : Metal 4
2025-11-24 23:56:23,416 - INFO - RAM                 : 128.0 GB
2025-11-24 23:56:23,416 - INFO - CPU Cores (Physical): 16
2025-11-24 23:56:23,417 - INFO - CPU Cores (Logical) : 16
