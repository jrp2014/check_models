2025-11-25 21:02:17,036 - INFO - Full environment dump written to:
2025-11-25 21:02:17,036 - INFO - /Users/jrp/Documents/AI/mlx/check_models/src/output/environment.log
2025-11-25 21:02:17,036 - DEBUG - Environment details saved for reproducibility
2025-11-25 21:02:17,037 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:17,037 - WARNING - âš ï¸  SECURITY WARNING: --trust-remote-code is enabled.
2025-11-25 21:02:17,037 - WARNING - âš ï¸  This allows execution of remote code and may pose security risks.
2025-11-25 21:02:17,037 - INFO - ====================================================================================================
2025-11-25 21:02:17,037 - INFO - MLX Vision Language Model Check
2025-11-25 21:02:17,037 - INFO - ====================================================================================================
2025-11-25 21:02:17,037 - INFO - Scanning folder: /Users/jrp/Pictures/Processed
2025-11-25 21:02:17,048 - DEBUG - Most recent image file found: /Users/jrp/Pictures/Processed/20251115-161928_DSC07372.jpg
2025-11-25 21:02:17,048 - INFO - Image File:      /Users/jrp/Pictures/Processed/20251115-161928_DSC07372.jpg
2025-11-25 21:02:17,053 - INFO - Image dimensions: 8640x5400 (46.7 MPixels)
2025-11-25 21:02:17,053 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:17,053 - INFO - Image Metadata
2025-11-25 21:02:17,054 - INFO - Date: 2025-11-15 16:19:28 GMT
2025-11-25 21:02:17,054 - INFO - Description: , White Rock, Hastings, England, United Kingdom, UK
Here is a caption for the image, written for the specified audience and context:

A damp, late autumn afternoon along the seafront at White Rock in Hastings, England. The low-angle perspective highlights the rain-slicked paving stones, which reflect the cool, overcast sky as dusk begins to fall. In the background, a row of hotels and apartments, typical of a British seaside town, lines the road. The motion blur of a passing car's taillights adds a streak of colour and a sense of movement to the otherwise quiet, atmospheric scene. This area was developed significantly during the Victorian era as Hastings grew into a popular coastal resort, and this image captures a modern, tranquil moment outside the peak tourist season.
2025-11-25 21:02:17,054 - INFO - GPS Location: 
2025-11-25 21:02:17,054 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:17,054 - INFO - Prompt Configuration
2025-11-25 21:02:17,054 - INFO - Using user-provided prompt.
2025-11-25 21:02:17,054 - INFO - Final prompt: Provide a factual caption, description, and keywords suitable for cataloguing, or searching for, the image
2025-11-25 21:02:17,054 - INFO - Processing specified models: mlx-community/Qwen2-VL-2B-Instruct-4bit
2025-11-25 21:02:17,054 - INFO - Processing 1 model(s)...
2025-11-25 21:02:17,054 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:17,054 - INFO - 
2025-11-25 21:02:17,054 - INFO - Processing Model [1/1]: mlx-community/Qwen2-VL-2B-Instruct-4bit
2025-11-25 21:02:17,342 - DEBUG - System: arm64, GPU: Apple M4 Max
2025-11-25 21:02:18,475 - ERROR - Runtime error for mlx-community/Qwen2-VL-2B-Instruct-4bit
Traceback (most recent call last):
  File "/Users/jrp/Documents/AI/mlx/check_models/src/check_models.py", line 4655, in _run_model_generation
    output: GenerationResult | SupportsGenerationResult = generate(
                                                          ~~~~~~~~^
        model=model,
        ^^^^^^^^^^^^
    ...<13 lines>...
        max_tokens=params.max_tokens,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 539, in generate
    for response in stream_generate(model, processor, prompt, image, audio, **kwargs):
                    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 429, in stream_generate
    for n, (token, logprobs) in enumerate(
                                ~~~~~~~~~^
        generate_step(input_ids, model, pixel_values, mask, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Users/jrp/Documents/AI/mlx/mlx-vlm/mlx_vlm/generate.py", line 324, in generate_step
    mx.async_eval(y)
    ~~~~~~~~~~~~~^^^
RuntimeError: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.
2025-11-25 21:02:18,495 - DEBUG - Cleaned up resources for model mlx-community/Qwen2-VL-2B-Instruct-4bit
2025-11-25 21:02:18,496 - ERROR - [RUN 1/1] SUMMARY model=mlx-community/Qwen2-VL-2B-Instruct-4bit status=FAIL stage=OOM
2025-11-25 21:02:18,496 - INFO - 
2025-11-25 21:02:18,496 - INFO - 
2025-11-25 21:02:18,496 - INFO - Error: Model runtime error during generation for mlx-community/Qwen2-VL-2B-Instruct-4bit: [metal::malloc] Attempting to allocate 135383101952 bytes which is greater than the maximum allowed buffer size of 86586540032 bytes.
2025-11-25 21:02:18,496 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:18,496 - INFO - Performance Summary
2025-11-25 21:02:18,497 - INFO - Model                                      Generation    Load    Total  Quality    Output
2025-11-25 21:02:18,497 - INFO - Name                                              (s)     (s)      (s)  Issues
2025-11-25 21:02:18,497 - INFO - mlx-community/Qwen2-VL-2B-Instruct-4bit                                            Error: OOM - Model runtime error during generation
2025-11-25 21:02:18,497 - INFO -                                                                                    for mlx-community/Qwen2-VL-2B-Instruct-4bit:
2025-11-25 21:02:18,497 - INFO -                                                                                    [metal::malloc] Attempting to allocate
2025-11-25 21:02:18,497 - INFO -                                                                                    135383101952 bytes which is greater than the
2025-11-25 21:02:18,497 - INFO -                                                                                    maximum allowed buffer size of 86586540032 bytes.
2025-11-25 21:02:18,497 - INFO - 
2025-11-25 21:02:18,497 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:18,497 - INFO - Results Summary
2025-11-25 21:02:18,497 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:18,497 - INFO - âŒ Failed Models (1):
2025-11-25 21:02:18,497 - INFO -   - mlx-community/Qwen2-VL-2B-Instruct-4bit (OOM)
2025-11-25 21:02:18,497 - INFO - 
2025-11-25 21:02:19,235 - INFO - 
2025-11-25 21:02:19,235 - INFO - ğŸ“Š Reports successfully generated:
2025-11-25 21:02:19,235 - INFO -    HTML Report: /Users/jrp/Documents/AI/mlx/check_models/src/output/results.html
2025-11-25 21:02:19,235 - INFO -    Markdown Report: /Users/jrp/Documents/AI/mlx/check_models/src/output/results.md
2025-11-25 21:02:19,235 - INFO -    TSV Report:    /Users/jrp/Documents/AI/mlx/check_models/src/output/results.tsv
2025-11-25 21:02:19,235 - INFO -    JSONL Report:  /Users/jrp/Documents/AI/mlx/check_models/src/output/results.jsonl
2025-11-25 21:02:19,235 - INFO -    Log File: /Users/jrp/Documents/AI/mlx/check_models/src/output/check_models.log
2025-11-25 21:02:19,235 - INFO -    Environment: /Users/jrp/Documents/AI/mlx/check_models/src/output/environment.log
2025-11-25 21:02:19,235 - INFO - â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2025-11-25 21:02:19,235 - INFO - Final Summary
2025-11-25 21:02:19,235 - INFO - 
2025-11-25 21:02:19,235 - INFO - â±  Overall runtime: 2.51s
2025-11-25 21:02:19,235 - INFO - --- Library Versions ---
2025-11-25 21:02:19,235 - INFO - Pillow          : 12.0.0
2025-11-25 21:02:19,235 - INFO - huggingface-hub : 0.36.0
2025-11-25 21:02:19,235 - INFO - mlx             : 0.30.1.dev20251125+c9f4dc85
2025-11-25 21:02:19,235 - INFO - mlx-lm          : 0.28.4
2025-11-25 21:02:19,235 - INFO - mlx-vlm         : 0.3.7
2025-11-25 21:02:19,235 - INFO - tokenizers      : 0.22.1
2025-11-25 21:02:19,235 - INFO - transformers    : 4.57.3
2025-11-25 21:02:19,235 - INFO - Generated: 2025-11-25 21:02:19 GMT
2025-11-25 21:02:19,377 - INFO - 
2025-11-25 21:02:19,377 - INFO - --- System Information ---
2025-11-25 21:02:19,377 - INFO - OS                  : Darwin 25.1.0
2025-11-25 21:02:19,377 - INFO - macOS Version       : 26.1
2025-11-25 21:02:19,377 - INFO - SDK Version         : 26.1
2025-11-25 21:02:19,377 - INFO - Python Version      : 3.13.9
2025-11-25 21:02:19,377 - INFO - Architecture        : arm64
2025-11-25 21:02:19,377 - INFO - GPU/Chip            : Apple M4 Max
2025-11-25 21:02:19,377 - INFO - GPU Cores           : 40
2025-11-25 21:02:19,377 - INFO - Metal Support       : Metal 4
2025-11-25 21:02:19,377 - INFO - RAM                 : 128.0 GB
2025-11-25 21:02:19,377 - INFO - CPU Cores (Physical): 16
2025-11-25 21:02:19,377 - INFO - CPU Cores (Logical) : 16
